(()=>{"use strict";var __webpack_modules__={3292:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),shell_1=__webpack_require__(2140),config_1=__webpack_require__(5793),mailer_1=__webpack_require__(2138),path_1=__webpack_require__(1017),handlebars_adapter_1=__webpack_require__(2498);let AppModule=class AppModule{};AppModule=tslib_1.__decorate([(0,common_1.Module)({imports:[shell_1.ApiShellFeatureModule,mailer_1.MailerModule.forRootAsync({imports:[config_1.ConfigModule],useFactory:config=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){return{transport:{host:config.get("EMAIL_HOST"),secure:!1,auth:{user:config.get("EMAIL_USER"),pass:config.get("EMAIL_PASSWORD")}},defaults:{from:"blulancetech@gmail.com"},template:{dir:(0,path_1.join)(__dirname,"./mail_templates"),adapter:new handlebars_adapter_1.HandlebarsAdapter,options:{strict:!0}}}})),inject:[config_1.ConfigService]}),config_1.ConfigModule.forRoot()]})],AppModule),exports.AppModule=AppModule},8321:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(7966),exports)},7966:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthenticationModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),repository_1=__webpack_require__(4255),service_1=__webpack_require__(9029),auth_resolver_resolver_1=__webpack_require__(9988),service_2=__webpack_require__(9029),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432);let AuthenticationModule=class AuthenticationModule{};AuthenticationModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[auth_resolver_resolver_1.AuthResolver,service_1.AuthService,service_2.DriverRegisterHandler,prisma_1.PrismaService,service_2.UserLoginHandler,service_2.UserUpdateHandler,service_2.UserRegisterHandler,service_1.UserVerifyHandler,repository_1.AuthRepository,service_1.FindUserByIdHandler]})],AuthenticationModule),exports.AuthenticationModule=AuthenticationModule},9988:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthResolver=void 0;const tslib_1=__webpack_require__(752),service_1=__webpack_require__(9029),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(3265);let AuthResolver=class AuthResolver{constructor(authService){this.authService=authService}findUserById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return console.log("iuserId",id),yield this.authService.findUserById(id)}))}login(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const userObj=yield this.authService.login(email,password);if(userObj){const user=new entities_1.UserLogin;return user.id=userObj.id,user.email=userObj.email,user.isDriver=userObj.isDriver,userObj.isValidated?user.token="generate":user.token="",user}throw new Error("Invalid credentials")}))}register(name,surname,email,university,studentNumber,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const userObj=yield this.authService.register(name,surname,email,university,studentNumber,password);if(userObj){const user=new entities_1.UserLogin;user.id=userObj.id,user.email=userObj.email,user.verificationCode=`${Math.floor(1e5+9e5*Math.random())}`;const date=new Date;return date.setDate(date.getDate()+1),user.expires=date,console.log("before email"),yield this.authService.sendVerificationEmail(user.email,user.verificationCode),console.log("after email"),user}throw new Error("Something went wrong!")}))}registerDriver(ID,licensePlate,carModel,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const driverObj=yield this.authService.registerDriver(userId,licensePlate,carModel,ID);if(driverObj)return driverObj;throw new Error("Something went wrong!")}))}verifyEmail(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.verifyEmail(id)}))}updateUser(id,name,surname,email,university,studentNumber){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.updateUser(id,name,surname,email,university,studentNumber)}))}};tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_a="undefined"!=typeof Promise&&Promise)?_a:Object)],AuthResolver.prototype,"findUserById",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.UserLogin)),tslib_1.__param(0,(0,graphql_1.Args)("email")),tslib_1.__param(1,(0,graphql_1.Args)("password")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_b="undefined"!=typeof Promise&&Promise)?_b:Object)],AuthResolver.prototype,"login",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.UserLogin)),tslib_1.__param(0,(0,graphql_1.Args)("name")),tslib_1.__param(1,(0,graphql_1.Args)("surname")),tslib_1.__param(2,(0,graphql_1.Args)("email")),tslib_1.__param(3,(0,graphql_1.Args)("university")),tslib_1.__param(4,(0,graphql_1.Args)("studentNumber")),tslib_1.__param(5,(0,graphql_1.Args)("password")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_c="undefined"!=typeof Promise&&Promise)?_c:Object)],AuthResolver.prototype,"register",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.Driver)),tslib_1.__param(0,(0,graphql_1.Args)("ID")),tslib_1.__param(1,(0,graphql_1.Args)("licensePlate")),tslib_1.__param(2,(0,graphql_1.Args)("carModel")),tslib_1.__param(3,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_d="undefined"!=typeof Promise&&Promise)?_d:Object)],AuthResolver.prototype,"registerDriver",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>Boolean)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_e="undefined"!=typeof Promise&&Promise)?_e:Object)],AuthResolver.prototype,"verifyEmail",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__param(1,(0,graphql_1.Args)("name")),tslib_1.__param(2,(0,graphql_1.Args)("surname")),tslib_1.__param(3,(0,graphql_1.Args)("email")),tslib_1.__param(4,(0,graphql_1.Args)("university")),tslib_1.__param(5,(0,graphql_1.Args)("studentNumber")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_f="undefined"!=typeof Promise&&Promise)?_f:Object)],AuthResolver.prototype,"updateUser",null),AuthResolver=tslib_1.__decorate([(0,graphql_1.Resolver)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_g=void 0!==service_1.AuthService&&service_1.AuthService)?_g:Object])],AuthResolver),exports.AuthResolver=AuthResolver},3265:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(9004),exports),tslib_1.__exportStar(__webpack_require__(3176),exports)},9004:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiAuthenticationApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiAuthenticationApiSharedEntitiesDataAccessModule=class ApiAuthenticationApiSharedEntitiesDataAccessModule{};ApiAuthenticationApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiAuthenticationApiSharedEntitiesDataAccessModule),exports.ApiAuthenticationApiSharedEntitiesDataAccessModule=ApiAuthenticationApiSharedEntitiesDataAccessModule},3176:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserUpdate=exports.Driver=exports.DriverInput=exports.UserInput=exports.UserLogin=exports.User=void 0;const tslib_1=__webpack_require__(752),entities_1=__webpack_require__(8095),graphql_1=__webpack_require__(1161);let User=class User{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],User.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"password",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"studentNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"profilePic",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],User.prototype,"isDriver",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_a="undefined"!=typeof Date&&Date)?_a:Object)],User.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_b="undefined"!=typeof Date&&Date)?_b:Object)],User.prototype,"updatedAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],User.prototype,"isValidated",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[entities_1.Trip])),tslib_1.__metadata("design:type",Array)],User.prototype,"tripsCreated",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[entities_1.Booking])),tslib_1.__metadata("design:type",Array)],User.prototype,"bookings",void 0),User=tslib_1.__decorate([(0,graphql_1.ObjectType)()],User),exports.User=User;let UserLogin=class UserLogin{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],UserLogin.prototype,"isDriver",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"token",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"verificationCode",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_c="undefined"!=typeof Date&&Date)?_c:Object)],UserLogin.prototype,"expires",void 0),UserLogin=tslib_1.__decorate([(0,graphql_1.ObjectType)()],UserLogin),exports.UserLogin=UserLogin;let UserInput=class UserInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"password",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"studentNumber",void 0),UserInput=tslib_1.__decorate([(0,graphql_1.InputType)()],UserInput),exports.UserInput=UserInput;let DriverInput=class DriverInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"ID",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"licensePlate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"carModel",void 0),DriverInput=tslib_1.__decorate([(0,graphql_1.InputType)()],DriverInput),exports.DriverInput=DriverInput;let Driver=class Driver{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"idNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"license",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"licensePlate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"model",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"carPicture",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>User)),tslib_1.__metadata("design:type",User)],Driver.prototype,"user",void 0),Driver=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Driver),exports.Driver=Driver;let UserUpdate=class UserUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"studentNumber",void 0),UserUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],UserUpdate),exports.UserUpdate=UserUpdate},4255:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(7494),exports),tslib_1.__exportStar(__webpack_require__(5042),exports)},7494:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiAuthenticationRepositoryDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiAuthenticationRepositoryDataAccessModule=class ApiAuthenticationRepositoryDataAccessModule{};ApiAuthenticationRepositoryDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiAuthenticationRepositoryDataAccessModule),exports.ApiAuthenticationRepositoryDataAccessModule=ApiAuthenticationRepositoryDataAccessModule},5042:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthRepository=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),prisma_1=__webpack_require__(6432),bcrypt=__webpack_require__(7096);let AuthRepository=class AuthRepository{constructor(prisma){this.prisma=prisma}findUserById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.user.findUnique({where:{id}})}))}login(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const user=yield this.prisma.user.findUnique({where:{email}});if(user&&user.isValidated){if(yield bcrypt.compare(password,user.password))return user}else{if(!user)throw new common_1.NotFoundException(`User with email ${email} does not exist`);if(!user.isValidated)throw new common_1.UnauthorizedException("Email address has not been validated")}}))}register(user){return tslib_1.__awaiter(this,void 0,void 0,(function*(){if(yield this.prisma.user.findUnique({where:{email:user.email}}))throw new Error(`User with email ${user.email} already exists`);{const salt=yield bcrypt.genSalt(),hashedPassword=yield bcrypt.hash(user.password,salt);return this.prisma.user.create({data:{name:user.name,surname:user.surname,email:user.email,university:user.university,studentNumber:user.studentNumber,password:hashedPassword,profilePic:""}})}}))}registerDriver(driver){return tslib_1.__awaiter(this,void 0,void 0,(function*(){if(yield this.prisma.driver.findUnique({where:{userId:driver.userId}}))throw new Error("User with already registered as driver");{const driverCreated=yield this.prisma.driver.create({data:{idNumber:driver.ID,licensePlate:driver.licensePlate,model:driver.carModel,userId:driver.userId,license:"",carPicture:""}});return yield this.prisma.user.update({where:{id:driver.userId},data:{isDriver:!0}}),driverCreated}}))}validateEmail(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return!!(yield this.prisma.user.update({where:{id},data:{isValidated:!0}}))}))}updateUser(user){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const updatedUser=yield this.prisma.user.update({where:{id:user.id},data:{name:user.name,surname:user.surname,email:user.email,university:user.university,studentNumber:user.studentNumber}});if(updatedUser)return updatedUser}))}};AuthRepository=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_a:Object])],AuthRepository),exports.AuthRepository=AuthRepository},9029:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(6191),exports),tslib_1.__exportStar(__webpack_require__(8764),exports),tslib_1.__exportStar(__webpack_require__(3604),exports),tslib_1.__exportStar(__webpack_require__(7875),exports)},6191:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiAuthenticationServiceFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiAuthenticationServiceFeatureModule=class ApiAuthenticationServiceFeatureModule{};ApiAuthenticationServiceFeatureModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiAuthenticationServiceFeatureModule),exports.ApiAuthenticationServiceFeatureModule=ApiAuthenticationServiceFeatureModule},8764:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),auth_query_query_1=__webpack_require__(1891),auth_command_command_1=__webpack_require__(5614),mailer_1=__webpack_require__(2138);let AuthService=class AuthService{constructor(queryBus,commandBus,mailerService){this.queryBus=queryBus,this.commandBus=commandBus,this.mailerService=mailerService}findUserById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new auth_query_query_1.FindUserByIdQuery(id))}))}login(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new auth_query_query_1.UserLoginQuery(email,password))}))}register(name,surname,email,university,studentNumber,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.UserRegisterCommand(name,surname,email,university,studentNumber,password))}))}registerDriver(ID,licensePlate,carModel,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.DriverRegisterCommand(userId,licensePlate,carModel,ID))}))}verifyEmail(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.UserVerifyCommand(id))}))}sendVerificationEmail(email,code){return tslib_1.__awaiter(this,void 0,void 0,(function*(){yield this.mailerService.sendMail({to:email,subject:"Greeting from NestJS NodeMailer",template:"/confirm_email",context:{code}})}))}updateUser(id,name,surname,email,university,studentNumber){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.UserUpdateCommand(id,name,surname,email,university,studentNumber))}))}};AuthService=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==cqrs_1.QueryBus&&cqrs_1.QueryBus)?_a:Object,"function"==typeof(_b=void 0!==cqrs_1.CommandBus&&cqrs_1.CommandBus)?_b:Object,"function"==typeof(_c=void 0!==mailer_1.MailerService&&mailer_1.MailerService)?_c:Object])],AuthService),exports.AuthService=AuthService},7875:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserUpdateHandler=exports.UserVerifyHandler=exports.DriverRegisterHandler=exports.UserRegisterHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(4255),cqrs_1=__webpack_require__(4628),auth_command_command_1=__webpack_require__(5614),entities_1=__webpack_require__(3265);let UserRegisterHandler=class UserRegisterHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{name,surname,email,university,studentNumber,password}=command,user=new entities_1.UserInput;return user.name=name,user.surname=surname,user.email=email,user.university=university,user.studentNumber=studentNumber,user.password=password,yield this.authRepository.register(user)}))}};UserRegisterHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.UserRegisterCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_a:Object])],UserRegisterHandler),exports.UserRegisterHandler=UserRegisterHandler;let DriverRegisterHandler=class DriverRegisterHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{userId,licensePlate,carModel,ID}=command,driver=new entities_1.DriverInput;return driver.userId=userId,driver.licensePlate=licensePlate,driver.carModel=carModel,driver.ID=ID,yield this.authRepository.registerDriver(driver)}))}};DriverRegisterHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.DriverRegisterCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_b:Object])],DriverRegisterHandler),exports.DriverRegisterHandler=DriverRegisterHandler;let UserVerifyHandler=class UserVerifyHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{id}=command;return yield this.authRepository.validateEmail(id)}))}};UserVerifyHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.UserVerifyCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_c:Object])],UserVerifyHandler),exports.UserVerifyHandler=UserVerifyHandler;let UserUpdateHandler=class UserUpdateHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{id,name,surname,email,university,studentNumber}=command,user=new entities_1.UserUpdate;return user.id=id,user.name=name,user.surname=surname,user.email=email,user.university=university,user.studentNumber=studentNumber,yield this.authRepository.updateUser(user)}))}};UserUpdateHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.UserUpdateCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_d:Object])],UserUpdateHandler),exports.UserUpdateHandler=UserUpdateHandler},5614:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserUpdateCommand=exports.UserVerifyCommand=exports.DriverRegisterCommand=exports.UserRegisterCommand=void 0;exports.UserRegisterCommand=class UserRegisterCommand{constructor(name,surname,email,university,studentNumber,password){this.name=name,this.surname=surname,this.email=email,this.university=university,this.studentNumber=studentNumber,this.password=password}};exports.DriverRegisterCommand=class DriverRegisterCommand{constructor(ID,licensePlate,carModel,userId){this.ID=ID,this.licensePlate=licensePlate,this.carModel=carModel,this.userId=userId}};exports.UserVerifyCommand=class UserVerifyCommand{constructor(id){this.id=id}};exports.UserUpdateCommand=class UserUpdateCommand{constructor(id,name,surname,email,university,studentNumber){this.id=id,this.name=name,this.surname=surname,this.email=email,this.university=university,this.studentNumber=studentNumber}}},3604:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindUserByIdHandler=exports.UserLoginHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(4255),cqrs_1=__webpack_require__(4628),auth_query_query_1=__webpack_require__(1891);let UserLoginHandler=class UserLoginHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.login(query.email,query.password)}))}};UserLoginHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.UserLoginQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_a:Object])],UserLoginHandler),exports.UserLoginHandler=UserLoginHandler;let FindUserByIdHandler=class FindUserByIdHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findUserById(query.id)}))}};FindUserByIdHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindUserByIdQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_b:Object])],FindUserByIdHandler),exports.FindUserByIdHandler=FindUserByIdHandler},1891:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindUserByIdQuery=exports.UserLoginQuery=void 0;exports.UserLoginQuery=class UserLoginQuery{constructor(email,password){this.email=email,this.password=password}};exports.FindUserByIdQuery=class FindUserByIdQuery{constructor(id){this.id=id}}},1481:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(3865),exports)},3865:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BookingsModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),service_1=__webpack_require__(9029),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_2=__webpack_require__(4071),repository_1=__webpack_require__(5621),bookings_resolver_resolver_1=__webpack_require__(9205),service_3=__webpack_require__(4071);let BookingsModule=class BookingsModule{};BookingsModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[service_1.AuthService,service_2.TripsService,repository_1.TripsRepository,bookings_resolver_resolver_1.BookingResolver,prisma_1.PrismaService,service_3.FindAllTripRequestsHandler]})],BookingsModule),exports.BookingsModule=BookingsModule},9205:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g;Object.defineProperty(exports,"__esModule",{value:!0}),exports.BookingResolver=void 0;const tslib_1=__webpack_require__(752),entities_1=__webpack_require__(3265),entities_2=__webpack_require__(8095),service_1=__webpack_require__(4071),graphql_1=__webpack_require__(1161),service_2=__webpack_require__(9029);let BookingResolver=class BookingResolver{constructor(tripsService,authService){this.tripsService=tripsService,this.authService=authService}user(booking){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(booking.userId)}))}trip(booking){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findTripById(booking.tripId)}))}findAllTripRequests(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findAllTripRequests(userId)}))}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==entities_2.Booking&&entities_2.Booking)?_a:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_b="undefined"!=typeof Promise&&Promise)?_b:Object)],BookingResolver.prototype,"user",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==entities_2.Booking&&entities_2.Booking)?_c:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_d="undefined"!=typeof Promise&&Promise)?_d:Object)],BookingResolver.prototype,"trip",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Booking])),tslib_1.__param(0,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_e="undefined"!=typeof Promise&&Promise)?_e:Object)],BookingResolver.prototype,"findAllTripRequests",null),BookingResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_2.Booking)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==service_1.TripsService&&service_1.TripsService)?_f:Object,"function"==typeof(_g=void 0!==service_2.AuthService&&service_2.AuthService)?_g:Object])],BookingResolver),exports.BookingResolver=BookingResolver},7217:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(7681),exports)},7681:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),data_access_1=__webpack_require__(7842),feature_1=__webpack_require__(6500),message_resolver_resolver_1=__webpack_require__(85),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_1=__webpack_require__(9029);let MessageModule=class MessageModule{};MessageModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[message_resolver_resolver_1.MessageResolver,feature_1.MessageService,feature_1.CreateMessageHandler,feature_1.GetMessagesHandler,prisma_1.PrismaService,service_1.AuthService,data_access_1.MessageRepository,feature_1.GetChatsHandler]})],MessageModule),exports.MessageModule=MessageModule},85:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageResolver=void 0;const tslib_1=__webpack_require__(752),feature_1=__webpack_require__(6500),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(8194),entities_2=__webpack_require__(3265),entities_3=__webpack_require__(8194),service_1=__webpack_require__(9029),pubSub=new(__webpack_require__(1283).PubSub);let MessageResolver=class MessageResolver{constructor(messageService,authService){this.messageService=messageService,this.authService=authService}sender(message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(message.senderId)}))}receiver(message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(message.receiverId)}))}getMessages(senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageService.getMessages(senderId,receiverId)}))}getChats(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageService.getChats(userId)}))}createMessage(message,senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const newMessage=yield this.messageService.createMessage(senderId,receiverId,message);return pubSub.publish("messageSent",{messageSent:newMessage}),newMessage}))}messageSent(){return pubSub.asyncIterator("messageSent")}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_2.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==entities_1.Message&&entities_1.Message)?_a:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_b="undefined"!=typeof Promise&&Promise)?_b:Object)],MessageResolver.prototype,"sender",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_2.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==entities_1.Message&&entities_1.Message)?_c:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_d="undefined"!=typeof Promise&&Promise)?_d:Object)],MessageResolver.prototype,"receiver",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_1.Message])),tslib_1.__param(0,(0,graphql_1.Args)("senderId")),tslib_1.__param(1,(0,graphql_1.Args)("receiverId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_e="undefined"!=typeof Promise&&Promise)?_e:Object)],MessageResolver.prototype,"getMessages",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_3.Chat])),tslib_1.__param(0,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_f="undefined"!=typeof Promise&&Promise)?_f:Object)],MessageResolver.prototype,"getChats",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.Message)),tslib_1.__param(0,(0,graphql_1.Args)("message")),tslib_1.__param(1,(0,graphql_1.Args)("senderId")),tslib_1.__param(2,(0,graphql_1.Args)("receiverId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_g="undefined"!=typeof Promise&&Promise)?_g:Object)],MessageResolver.prototype,"createMessage",null),tslib_1.__decorate([(0,graphql_1.Subscription)((()=>entities_1.Message),{name:"messageSent"}),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype",void 0)],MessageResolver.prototype,"messageSent",null),MessageResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_1.Message)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==feature_1.MessageService&&feature_1.MessageService)?_h:Object,"function"==typeof(_j=void 0!==service_1.AuthService&&service_1.AuthService)?_j:Object])],MessageResolver),exports.MessageResolver=MessageResolver},8194:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(9547),exports),tslib_1.__exportStar(__webpack_require__(9179),exports)},9547:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiMessagesApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiMessagesApiSharedEntitiesDataAccessModule=class ApiMessagesApiSharedEntitiesDataAccessModule{};ApiMessagesApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiMessagesApiSharedEntitiesDataAccessModule),exports.ApiMessagesApiSharedEntitiesDataAccessModule=ApiMessagesApiSharedEntitiesDataAccessModule},9179:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageInput=exports.Chat=exports.Message=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(3265);let Message=class Message{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Message.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Message.prototype,"message",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Message.prototype,"senderId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Message.prototype,"receiverId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_a=void 0!==entities_1.User&&entities_1.User)?_a:Object)],Message.prototype,"sender",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_b=void 0!==entities_1.User&&entities_1.User)?_b:Object)],Message.prototype,"receiver",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_c="undefined"!=typeof Date&&Date)?_c:Object)],Message.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_d="undefined"!=typeof Date&&Date)?_d:Object)],Message.prototype,"updatedAt",void 0),Message=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Message),exports.Message=Message;let Chat=class Chat{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Chat.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Chat.prototype,"name",void 0),Chat=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Chat),exports.Chat=Chat;let MessageInput=class MessageInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],MessageInput.prototype,"message",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],MessageInput.prototype,"senderId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],MessageInput.prototype,"receiverId",void 0),MessageInput=tslib_1.__decorate([(0,graphql_1.InputType)()],MessageInput),exports.MessageInput=MessageInput},7842:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(6942),exports),tslib_1.__exportStar(__webpack_require__(2470),exports)},6942:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiMessagesRepositoryDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiMessagesRepositoryDataAccessModule=class ApiMessagesRepositoryDataAccessModule{};ApiMessagesRepositoryDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiMessagesRepositoryDataAccessModule),exports.ApiMessagesRepositoryDataAccessModule=ApiMessagesRepositoryDataAccessModule},2470:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageRepository=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),prisma_1=__webpack_require__(6432),entities_1=__webpack_require__(8194);let MessageRepository=class MessageRepository{constructor(prisma){this.prisma=prisma}createMessage(message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.message.create({data:{senderId:message.senderId,receiverId:message.receiverId,message:message.message}})}))}getMessages(senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.message.findMany({where:{OR:[{senderId,receiverId},{senderId:receiverId,receiverId:senderId}]}})}))}getChats(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const chats=yield this.prisma.message.findMany({where:{OR:[{receiverId:userId},{senderId:userId}]},select:{senderId:!0,receiverId:!0,sender:{select:{name:!0,surname:!0}},receiver:{select:{name:!0,surname:!0}}}});let uniqueChats=[];return chats.map((chat=>{const chatObj=new entities_1.Chat;chat.senderId===userId?(chatObj.userId=chat.receiverId,chatObj.name=`${chat.receiver.name} ${chat.receiver.surname}`):(chatObj.userId=chat.senderId,chatObj.name=`${chat.sender.name} ${chat.sender.surname}`),uniqueChats.push(chatObj)})),console.log(uniqueChats),uniqueChats=uniqueChats.filter(((value,index,self)=>index===self.findIndex((t=>t.name===value.name&&t.userId===value.userId)))),uniqueChats}))}};MessageRepository=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_a:Object])],MessageRepository),exports.MessageRepository=MessageRepository},6500:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(9439),exports),tslib_1.__exportStar(__webpack_require__(3147),exports),tslib_1.__exportStar(__webpack_require__(5993),exports),tslib_1.__exportStar(__webpack_require__(8106),exports)},9439:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiMessagesServiceFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiMessagesServiceFeatureModule=class ApiMessagesServiceFeatureModule{};ApiMessagesServiceFeatureModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiMessagesServiceFeatureModule),exports.ApiMessagesServiceFeatureModule=ApiMessagesServiceFeatureModule},8106:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateMessageHandler=void 0;const tslib_1=__webpack_require__(752),data_access_1=__webpack_require__(7842),cqrs_1=__webpack_require__(4628),message_command_command_1=__webpack_require__(8805),entities_1=__webpack_require__(8194);let CreateMessageHandler=class CreateMessageHandler{constructor(messageRepository){this.messageRepository=messageRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{senderId,receiverId,message}=command,messageObj=new entities_1.MessageInput;return messageObj.senderId=senderId,messageObj.receiverId=receiverId,messageObj.message=message,yield this.messageRepository.createMessage(messageObj)}))}};CreateMessageHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(message_command_command_1.CreateMessageCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==data_access_1.MessageRepository&&data_access_1.MessageRepository)?_a:Object])],CreateMessageHandler),exports.CreateMessageHandler=CreateMessageHandler},8805:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateMessageCommand=void 0;exports.CreateMessageCommand=class CreateMessageCommand{constructor(senderId,receiverId,message){this.senderId=senderId,this.receiverId=receiverId,this.message=message}}},3147:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),message_query_query_1=__webpack_require__(6106),message_command_command_1=__webpack_require__(8805);let MessageService=class MessageService{constructor(queryBus,commandBus){this.queryBus=queryBus,this.commandBus=commandBus}getMessages(senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new message_query_query_1.GetMessagesQuery(senderId,receiverId))}))}getChats(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new message_query_query_1.GetChatsQuery(userId))}))}createMessage(senderId,receiverId,message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new message_command_command_1.CreateMessageCommand(senderId,receiverId,message))}))}};MessageService=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==cqrs_1.QueryBus&&cqrs_1.QueryBus)?_a:Object,"function"==typeof(_b=void 0!==cqrs_1.CommandBus&&cqrs_1.CommandBus)?_b:Object])],MessageService),exports.MessageService=MessageService},5993:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.GetChatsHandler=exports.GetMessagesHandler=void 0;const tslib_1=__webpack_require__(752),data_access_1=__webpack_require__(7842),cqrs_1=__webpack_require__(4628),message_query_query_1=__webpack_require__(6106);let GetMessagesHandler=class GetMessagesHandler{constructor(messageRepository){this.messageRepository=messageRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageRepository.getMessages(query.senderId,query.receiverId)}))}};GetMessagesHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(message_query_query_1.GetMessagesQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==data_access_1.MessageRepository&&data_access_1.MessageRepository)?_a:Object])],GetMessagesHandler),exports.GetMessagesHandler=GetMessagesHandler;let GetChatsHandler=class GetChatsHandler{constructor(messageRepository){this.messageRepository=messageRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageRepository.getChats(query.userId)}))}};GetChatsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(message_query_query_1.GetChatsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==data_access_1.MessageRepository&&data_access_1.MessageRepository)?_b:Object])],GetChatsHandler),exports.GetChatsHandler=GetChatsHandler},6106:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.GetChatsQuery=exports.GetMessagesQuery=void 0;exports.GetMessagesQuery=class GetMessagesQuery{constructor(senderId,receiverId){this.senderId=senderId,this.receiverId=receiverId}};exports.GetChatsQuery=class GetChatsQuery{constructor(userId){this.userId=userId}}},6432:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(2099),exports),tslib_1.__exportStar(__webpack_require__(6967),exports)},2099:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiSharedServicesPrismaDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiSharedServicesPrismaDataAccessModule=class ApiSharedServicesPrismaDataAccessModule{};ApiSharedServicesPrismaDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiSharedServicesPrismaDataAccessModule),exports.ApiSharedServicesPrismaDataAccessModule=ApiSharedServicesPrismaDataAccessModule},6967:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrismaService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),client_1=__webpack_require__(3524);let PrismaService=class PrismaService extends client_1.PrismaClient{onModuleInit(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){yield this.$connect()}))}enableShutdownHooks(app){return tslib_1.__awaiter(this,void 0,void 0,(function*(){this.$on("beforeExit",(()=>tslib_1.__awaiter(this,void 0,void 0,(function*(){yield app.close()}))))}))}};PrismaService=tslib_1.__decorate([(0,common_1.Injectable)()],PrismaService),exports.PrismaService=PrismaService},2140:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(2455),exports)},2455:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiShellFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),resolvers_1=__webpack_require__(8321),graphql_1=__webpack_require__(1161),apollo_1=__webpack_require__(9096),resolvers_2=__webpack_require__(3149),resolvers_3=__webpack_require__(1481),feature_1=__webpack_require__(6945),feature_2=__webpack_require__(7217);let ApiShellFeatureModule=class ApiShellFeatureModule{};ApiShellFeatureModule=tslib_1.__decorate([(0,common_1.Module)({imports:[resolvers_1.AuthenticationModule,feature_1.WeatherModule,resolvers_2.TripsModule,resolvers_3.BookingsModule,feature_2.MessageModule,graphql_1.GraphQLModule.forRoot({autoSchemaFile:!0,playground:!0,introspection:!0,driver:apollo_1.ApolloDriver,subscriptions:{"graphql-ws":!0,"subscriptions-transport-ws":!0}})]})],ApiShellFeatureModule),exports.ApiShellFeatureModule=ApiShellFeatureModule},3149:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(4829),exports)},4829:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),repository_1=__webpack_require__(5621),service_1=__webpack_require__(4071),trips_resolver_resolver_1=__webpack_require__(2480),service_2=__webpack_require__(4071),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_3=__webpack_require__(9029);let TripsModule=class TripsModule{};TripsModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[trips_resolver_resolver_1.TripsResolver,repository_1.TripsRepository,service_1.TripsService,prisma_1.PrismaService,service_2.FindAllHandler,service_2.FindByDriverHandler,service_2.FindByPassengerHandler,service_2.TripsCreateHandler,service_2.SearchTripsHandler,service_2.BookTripHandler,service_2.FindBookingByTripHandler,service_2.TripsDeleteHandler,service_2.TripsUpdateHandler,service_2.FindCoordinatesByTripHandler,service_2.FindTripByIdHandler,service_3.AuthService,service_2.FindByConfirmedTripHandler,service_2.FindByRequestedTripHandler,service_2.BookingUpdatePaymentStatusHandler,service_2.FindBookingByTripAndUserIdHandler,service_2.AcceptTripRequestHandler,service_2.StartTripHandler,service_2.EndTripHandler,service_2.DeclineTripRequestHandler]})],TripsModule),exports.TripsModule=TripsModule},2480:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsResolver=void 0;const tslib_1=__webpack_require__(752),entities_1=__webpack_require__(3265),entities_2=__webpack_require__(8095),service_1=__webpack_require__(4071),graphql_1=__webpack_require__(1161),service_2=__webpack_require__(9029);let TripsResolver=class TripsResolver{constructor(tripsService,authService){this.tripsService=tripsService,this.authService=authService}coordinates(trip){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findCoordinatesByTrip(trip.tripId)}))}passengers(trip){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingByTrip(trip.tripId)}))}driver(trip){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(trip.driverId)}))}findAllTrips(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findAll()}))}findTripById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findTripById(id)}))}findByDriver(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByDriver(id)}))}findByPassenger(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByPassenger(id)}))}findBookingByTripAndUserId(tripId,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingByTripAndUserId(tripId,userId)}))}findByConfirmedTrips(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByConfirmedTrips(id)}))}findByRequestedTrips(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByRequestedTrips(id)}))}searchTrips(date,startLongitude,startLatitude,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trips=yield this.tripsService.searchTrips(date),searchResults=[];return 0!==trips.length&&trips.map((trip=>{trip.coordinates[0].longitude===startLongitude&&trip.coordinates[0].latitude===startLatitude&&trip.coordinates[1].longitude===destinationLongitude&&trip.coordinates[1].latitude===destinationLatitude&&searchResults.push(trip)})),searchResults}))}create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude)}))}updatePaymentStatus(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.updatePaymentStatus(bookingId)}))}bookTrip(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.bookTrip(passengerId,tripId,seatsBooked,status,price,address,longitude,latitude)}))}acceptTripRequest(tripId,bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.acceptTripRequest(tripId,bookingId)}))}declineTripRequest(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.declineTripRequest(bookingId)}))}startTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.startTrip(tripId)}))}endTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.endTrip(tripId)}))}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>[entities_2.Booking])),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==entities_2.Trip&&entities_2.Trip)?_a:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_b="undefined"!=typeof Promise&&Promise)?_b:Object)],TripsResolver.prototype,"coordinates",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>[entities_2.Location])),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==entities_2.Trip&&entities_2.Trip)?_c:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_d="undefined"!=typeof Promise&&Promise)?_d:Object)],TripsResolver.prototype,"passengers",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==entities_2.Trip&&entities_2.Trip)?_e:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_f="undefined"!=typeof Promise&&Promise)?_f:Object)],TripsResolver.prototype,"driver",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_g="undefined"!=typeof Promise&&Promise)?_g:Object)],TripsResolver.prototype,"findAllTrips",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_h="undefined"!=typeof Promise&&Promise)?_h:Object)],TripsResolver.prototype,"findTripById",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_j="undefined"!=typeof Promise&&Promise)?_j:Object)],TripsResolver.prototype,"findByDriver",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_k="undefined"!=typeof Promise&&Promise)?_k:Object)],TripsResolver.prototype,"findByPassenger",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("tripId")),tslib_1.__param(1,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_l="undefined"!=typeof Promise&&Promise)?_l:Object)],TripsResolver.prototype,"findBookingByTripAndUserId",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_m="undefined"!=typeof Promise&&Promise)?_m:Object)],TripsResolver.prototype,"findByConfirmedTrips",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_o="undefined"!=typeof Promise&&Promise)?_o:Object)],TripsResolver.prototype,"findByRequestedTrips",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("date")),tslib_1.__param(1,(0,graphql_1.Args)("startLongitude")),tslib_1.__param(2,(0,graphql_1.Args)("startLatitude")),tslib_1.__param(3,(0,graphql_1.Args)("destinationLongitude")),tslib_1.__param(4,(0,graphql_1.Args)("destinationLatitude")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_p="undefined"!=typeof Promise&&Promise)?_p:Object)],TripsResolver.prototype,"searchTrips",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("driver")),tslib_1.__param(1,(0,graphql_1.Args)("tripDate")),tslib_1.__param(2,(0,graphql_1.Args)("seatsAvailable")),tslib_1.__param(3,(0,graphql_1.Args)("price")),tslib_1.__param(4,(0,graphql_1.Args)("status")),tslib_1.__param(5,(0,graphql_1.Args)("startLocationAddress")),tslib_1.__param(6,(0,graphql_1.Args)("startLocationLongitude")),tslib_1.__param(7,(0,graphql_1.Args)("startLocationLatitude")),tslib_1.__param(8,(0,graphql_1.Args)("destinationAddress")),tslib_1.__param(9,(0,graphql_1.Args)("destinationLongitude")),tslib_1.__param(10,(0,graphql_1.Args)("destinationLatitude")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_q="undefined"!=typeof Promise&&Promise)?_q:Object)],TripsResolver.prototype,"create",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_r="undefined"!=typeof Promise&&Promise)?_r:Object)],TripsResolver.prototype,"updatePaymentStatus",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("tripId")),tslib_1.__param(1,(0,graphql_1.Args)("passengerId")),tslib_1.__param(2,(0,graphql_1.Args)("seatsBooked")),tslib_1.__param(3,(0,graphql_1.Args)("status")),tslib_1.__param(4,(0,graphql_1.Args)("price")),tslib_1.__param(5,(0,graphql_1.Args)("address")),tslib_1.__param(6,(0,graphql_1.Args)("longitude")),tslib_1.__param(7,(0,graphql_1.Args)("latitude")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_s="undefined"!=typeof Promise&&Promise)?_s:Object)],TripsResolver.prototype,"bookTrip",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__param(1,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_t="undefined"!=typeof Promise&&Promise)?_t:Object)],TripsResolver.prototype,"acceptTripRequest",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_u="undefined"!=typeof Promise&&Promise)?_u:Object)],TripsResolver.prototype,"declineTripRequest",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_v="undefined"!=typeof Promise&&Promise)?_v:Object)],TripsResolver.prototype,"startTrip",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_w="undefined"!=typeof Promise&&Promise)?_w:Object)],TripsResolver.prototype,"endTrip",null),TripsResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_2.Trip)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_x=void 0!==service_1.TripsService&&service_1.TripsService)?_x:Object,"function"==typeof(_y=void 0!==service_2.AuthService&&service_2.AuthService)?_y:Object])],TripsResolver),exports.TripsResolver=TripsResolver},8095:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(8027),exports),tslib_1.__exportStar(__webpack_require__(1715),exports),tslib_1.__exportStar(__webpack_require__(9477),exports),tslib_1.__exportStar(__webpack_require__(4870),exports),tslib_1.__exportStar(__webpack_require__(5623),exports)},8027:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiTripsApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiTripsApiSharedEntitiesDataAccessModule=class ApiTripsApiSharedEntitiesDataAccessModule{};ApiTripsApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiTripsApiSharedEntitiesDataAccessModule),exports.ApiTripsApiSharedEntitiesDataAccessModule=ApiTripsApiSharedEntitiesDataAccessModule},1715:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.BookingStatusUpdate=exports.BookingInput=exports.Booking=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),pickuplocation_entity_entity_1=__webpack_require__(5623),entities_1=__webpack_require__(3265),trip_entity_entity_1=__webpack_require__(9477);let Booking=class Booking{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Booking.prototype,"bookingId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Booking.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Booking.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_a="undefined"!=typeof Date&&Date)?_a:Object)],Booking.prototype,"bookingDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Int)),tslib_1.__metadata("design:type",Number)],Booking.prototype,"seatsBooked",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Booking.prototype,"status",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Float)),tslib_1.__metadata("design:type",Number)],Booking.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>pickuplocation_entity_entity_1.PickupLocation)),tslib_1.__metadata("design:type","function"==typeof(_b=void 0!==pickuplocation_entity_entity_1.PickupLocation&&pickuplocation_entity_entity_1.PickupLocation)?_b:Object)],Booking.prototype,"pickUp",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_c=void 0!==entities_1.User&&entities_1.User)?_c:Object)],Booking.prototype,"user",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>trip_entity_entity_1.Trip)),tslib_1.__metadata("design:type","function"==typeof(_d=void 0!==trip_entity_entity_1.Trip&&trip_entity_entity_1.Trip)?_d:Object)],Booking.prototype,"trip",void 0),Booking=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Booking),exports.Booking=Booking;let BookingInput=class BookingInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"bookingDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"seatsBooked",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"status",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"price",void 0),BookingInput=tslib_1.__decorate([(0,graphql_1.InputType)()],BookingInput),exports.BookingInput=BookingInput;let BookingStatusUpdate=class BookingStatusUpdate{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],BookingStatusUpdate.prototype,"bookingId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingStatusUpdate.prototype,"status",void 0),BookingStatusUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],BookingStatusUpdate),exports.BookingStatusUpdate=BookingStatusUpdate},4870:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocationInput=exports.Location=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),trip_entity_entity_1=__webpack_require__(9477);let Location=class Location{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Location.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"longitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>trip_entity_entity_1.Trip)),tslib_1.__metadata("design:type","function"==typeof(_a=void 0!==trip_entity_entity_1.Trip&&trip_entity_entity_1.Trip)?_a:Object)],Location.prototype,"trip",void 0),Location=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Location),exports.Location=Location;let LocationInput=class LocationInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],LocationInput.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],LocationInput.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],LocationInput.prototype,"longitude",void 0),LocationInput=tslib_1.__decorate([(0,graphql_1.InputType)()],LocationInput),exports.LocationInput=LocationInput},5623:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PickupLocationInput=exports.PickupLocation=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),booking_entity_entity_1=__webpack_require__(1715);let PickupLocation=class PickupLocation{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"longitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"bookingId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>booking_entity_entity_1.Booking)),tslib_1.__metadata("design:type","function"==typeof(_a=void 0!==booking_entity_entity_1.Booking&&booking_entity_entity_1.Booking)?_a:Object)],PickupLocation.prototype,"booking",void 0),PickupLocation=tslib_1.__decorate([(0,graphql_1.ObjectType)()],PickupLocation),exports.PickupLocation=PickupLocation;let PickupLocationInput=class PickupLocationInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"longitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"bookingId",void 0),PickupLocationInput=tslib_1.__decorate([(0,graphql_1.InputType)()],PickupLocationInput),exports.PickupLocationInput=PickupLocationInput},9477:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripStatusUpdate=exports.AcceptTripRequestUpdate=exports.TripsUpdate=exports.TripsInput=exports.Trip=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(3265),booking_entity_entity_1=__webpack_require__(1715),location_entity_entity_1=__webpack_require__(4870);let Trip=class Trip{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Trip.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Trip.prototype,"driverId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_a="undefined"!=typeof Date&&Date)?_a:Object)],Trip.prototype,"tripDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_b="undefined"!=typeof Date&&Date)?_b:Object)],Trip.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Int)),tslib_1.__metadata("design:type",Number)],Trip.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Float)),tslib_1.__metadata("design:type",Number)],Trip.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_c=void 0!==entities_1.User&&entities_1.User)?_c:Object)],Trip.prototype,"driver",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Trip.prototype,"status",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[booking_entity_entity_1.Booking])),tslib_1.__metadata("design:type",Array)],Trip.prototype,"passengers",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[location_entity_entity_1.Location])),tslib_1.__metadata("design:type",Array)],Trip.prototype,"coordinates",void 0),Trip=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Trip),exports.Trip=Trip;let TripsInput=class TripsInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"driverId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"tripDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[location_entity_entity_1.LocationInput])),tslib_1.__metadata("design:type",Array)],TripsInput.prototype,"coordinates",void 0),TripsInput=tslib_1.__decorate([(0,graphql_1.InputType)()],TripsInput),exports.TripsInput=TripsInput;let TripsUpdate=class TripsUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",Number)],TripsUpdate.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",Number)],TripsUpdate.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsUpdate.prototype,"status",void 0),TripsUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],TripsUpdate),exports.TripsUpdate=TripsUpdate;let AcceptTripRequestUpdate=class AcceptTripRequestUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",Number)],AcceptTripRequestUpdate.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AcceptTripRequestUpdate.prototype,"status",void 0),AcceptTripRequestUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],AcceptTripRequestUpdate),exports.AcceptTripRequestUpdate=AcceptTripRequestUpdate;let TripStatusUpdate=class TripStatusUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripStatusUpdate.prototype,"status",void 0),TripStatusUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],TripStatusUpdate),exports.TripStatusUpdate=TripStatusUpdate},5621:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(5870),exports),tslib_1.__exportStar(__webpack_require__(4606),exports)},5870:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiTripsRepositoryDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiTripsRepositoryDataAccessModule=class ApiTripsRepositoryDataAccessModule{};ApiTripsRepositoryDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiTripsRepositoryDataAccessModule),exports.ApiTripsRepositoryDataAccessModule=ApiTripsRepositoryDataAccessModule},4606:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsRepository=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),prisma_1=__webpack_require__(6432),formatDate=date=>{const dateObj=new Date(date),day=dateObj.getDate(),month=dateObj.getMonth(),year=dateObj.getFullYear();return`${day} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][month]} ${year}`};let TripsRepository=class TripsRepository{constructor(prisma){this.prisma=prisma}findAll(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.trip.findMany({orderBy:{tripDate:"desc"}})}))}findTripById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findUnique({where:{tripId:id}})}))}findByDriver(driverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.trip.findMany({where:{driverId}})}))}findByPassenger(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findMany({where:{passengers:{some:{userId:passengerId}}}})}))}findByConfirmedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findMany({where:{passengers:{some:{userId:passengerId,status:"unpaid"}},status:"confirmed"}})}))}findByRequestedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.trip.findMany({where:{passengers:{some:{userId:passengerId,status:"unpaid"}},status:"requested"}})}))}findBookingByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.findMany({where:{tripId:tripID}})}))}findBookingByTripAndUserId(tripID,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return(yield this.prisma.booking.findMany({where:{tripId:tripID,userId}}))[0]}))}findCoordinatesByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.location.findMany({where:{tripId:tripID}})}))}create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.create({data:{tripDate,seatsAvailable:parseInt(seatsAvailable),price:parseFloat(price),status,coordinates:{create:[{address:startLocationAddress,latitude:startLocationLatitude,longitude:startLocationLongitude},{address:destinationAddress,latitude:destinationLatitude,longitude:destinationLongitude}]},driver:{connect:{id:driver}}}})}))}bookTrip(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.create({data:{trip:{connect:{tripId}},user:{connect:{id:passengerId}},seatsBooked:parseInt(seatsBooked),status,price:parseFloat(price),pickUp:{create:{address,latitude,longitude}}}})}))}update(id,trips){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.update({where:{tripId:id},data:{seatsAvailable:trips.seatsAvailable,price:trips.price}})}))}updatePaymentStatus(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.update({where:{bookingId:id},data:{status:"paid"}})}))}delete(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.delete({where:{tripId:id}})}))}searchTrips(date){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const allTrips=yield this.prisma.trip.findMany({select:{tripId:!0,tripDate:!0,seatsAvailable:!0,price:!0,driverId:!0,coordinates:!0,driver:{select:{id:!0,name:!0,profilePic:!0}},createdAt:!0}}),tripsByDate=[];return 0!==allTrips.length?(allTrips.map((trip=>{formatDate(`${trip.tripDate}`)===formatDate(date)&&tripsByDate.push(trip)})),console.log(tripsByDate),tripsByDate):[]}))}acceptTripRequest(id,bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trip=yield this.prisma.trip.update({where:{tripId:id},data:{seatsAvailable:{decrement:1}}});return yield this.prisma.booking.update({where:{bookingId},data:{status:"unpaid"}}),trip}))}declineTripRequest(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.update({where:{bookingId},data:{status:"declined"}})}))}startTrip(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.update({where:{tripId:id},data:{status:"active"}})}))}endTrip(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.update({where:{tripId:id},data:{status:"completed"}})}))}findAllTripRequests(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.findMany({where:{trip:{driverId:userId},status:"requested"}})}))}};TripsRepository=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_a:Object])],TripsRepository),exports.TripsRepository=TripsRepository},4071:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(8215),exports),tslib_1.__exportStar(__webpack_require__(2285),exports),tslib_1.__exportStar(__webpack_require__(1012),exports),tslib_1.__exportStar(__webpack_require__(7042),exports)},8215:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiTripsServiceFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiTripsServiceFeatureModule=class ApiTripsServiceFeatureModule{};ApiTripsServiceFeatureModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiTripsServiceFeatureModule),exports.ApiTripsServiceFeatureModule=ApiTripsServiceFeatureModule},7042:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j;Object.defineProperty(exports,"__esModule",{value:!0}),exports.EndTripHandler=exports.StartTripHandler=exports.DeclineTripRequestHandler=exports.AcceptTripRequestHandler=exports.TripsDeleteHandler=exports.BookingUpdatePaymentStatusHandler=exports.TripsUpdateHandler=exports.BookTripHandler=exports.TripsCreateHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(5621),cqrs_1=__webpack_require__(4628),trips_command_command_1=__webpack_require__(7577),entities_1=__webpack_require__(8095);let TripsCreateHandler=class TripsCreateHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude}=command;return yield this.tripsRepository.create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude)}))}};TripsCreateHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.TripsCreateCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_a:Object])],TripsCreateHandler),exports.TripsCreateHandler=TripsCreateHandler;let BookTripHandler=class BookTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId,passengerId,seatsBooked,status,price,address,longitude,latitude}=command;return yield this.tripsRepository.bookTrip(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude)}))}};BookTripHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.BookTripCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_b:Object])],BookTripHandler),exports.BookTripHandler=BookTripHandler;let TripsUpdateHandler=class TripsUpdateHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId,seatsAvailable,price,status}=command,tripUpdate=new entities_1.TripsUpdate;return tripUpdate.seatsAvailable=seatsAvailable,tripUpdate.price=price,tripUpdate.status=status,yield this.tripsRepository.update(tripId,tripUpdate)}))}};TripsUpdateHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.TripsUpdateCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_c:Object])],TripsUpdateHandler),exports.TripsUpdateHandler=TripsUpdateHandler;let BookingUpdatePaymentStatusHandler=class BookingUpdatePaymentStatusHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{bookingId}=command;return yield this.tripsRepository.updatePaymentStatus(bookingId)}))}};BookingUpdatePaymentStatusHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.BookingUpdatePaymentStatusCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_d:Object])],BookingUpdatePaymentStatusHandler),exports.BookingUpdatePaymentStatusHandler=BookingUpdatePaymentStatusHandler;let TripsDeleteHandler=class TripsDeleteHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId}=command;return yield this.tripsRepository.delete(tripId)}))}};TripsDeleteHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.TripsDeleteCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_e:Object])],TripsDeleteHandler),exports.TripsDeleteHandler=TripsDeleteHandler;let AcceptTripRequestHandler=class AcceptTripRequestHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId,bookingId}=command;return yield this.tripsRepository.acceptTripRequest(tripId,bookingId)}))}};AcceptTripRequestHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.AcceptTripRequestCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_f:Object])],AcceptTripRequestHandler),exports.AcceptTripRequestHandler=AcceptTripRequestHandler;let DeclineTripRequestHandler=class DeclineTripRequestHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{bookingId}=command;return yield this.tripsRepository.declineTripRequest(bookingId)}))}};DeclineTripRequestHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.DeclineTripRequestCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_g=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_g:Object])],DeclineTripRequestHandler),exports.DeclineTripRequestHandler=DeclineTripRequestHandler;let StartTripHandler=class StartTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId}=command;return yield this.tripsRepository.startTrip(tripId)}))}};StartTripHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.StartTripCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_h:Object])],StartTripHandler),exports.StartTripHandler=StartTripHandler;let EndTripHandler=class EndTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId}=command;return yield this.tripsRepository.endTrip(tripId)}))}};EndTripHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.EndTripCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_j=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_j:Object])],EndTripHandler),exports.EndTripHandler=EndTripHandler},7577:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeclineTripRequestCommand=exports.EndTripCommand=exports.StartTripCommand=exports.AcceptTripRequestCommand=exports.TripsDeleteCommand=exports.BookingUpdatePaymentStatusCommand=exports.TripsUpdateCommand=exports.BookTripCommand=exports.TripsCreateCommand=void 0;exports.TripsCreateCommand=class TripsCreateCommand{constructor(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){this.driver=driver,this.tripDate=tripDate,this.seatsAvailable=seatsAvailable,this.price=price,this.status=status,this.startLocationAddress=startLocationAddress,this.startLocationLongitude=startLocationLongitude,this.startLocationLatitude=startLocationLatitude,this.destinationAddress=destinationAddress,this.destinationLongitude=destinationLongitude,this.destinationLatitude=destinationLatitude}};exports.BookTripCommand=class BookTripCommand{constructor(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude){this.tripId=tripId,this.passengerId=passengerId,this.seatsBooked=seatsBooked,this.status=status,this.price=price,this.address=address,this.longitude=longitude,this.latitude=latitude}};exports.TripsUpdateCommand=class TripsUpdateCommand{constructor(tripId,seatsAvailable,price,status){this.tripId=tripId,this.seatsAvailable=seatsAvailable,this.price=price,this.status=status}};exports.BookingUpdatePaymentStatusCommand=class BookingUpdatePaymentStatusCommand{constructor(bookingId){this.bookingId=bookingId}};exports.TripsDeleteCommand=class TripsDeleteCommand{constructor(tripId){this.tripId=tripId}};exports.AcceptTripRequestCommand=class AcceptTripRequestCommand{constructor(tripId,bookingId){this.tripId=tripId,this.bookingId=bookingId}};exports.StartTripCommand=class StartTripCommand{constructor(tripId){this.tripId=tripId}};exports.EndTripCommand=class EndTripCommand{constructor(tripId){this.tripId=tripId}};exports.DeclineTripRequestCommand=class DeclineTripRequestCommand{constructor(bookingId){this.bookingId=bookingId}}},1012:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindAllTripRequestsHandler=exports.SearchTripsHandler=exports.FindTripByIdHandler=exports.FindCoordinatesByTripHandler=exports.FindBookingByTripAndUserIdHandler=exports.FindBookingByTripHandler=exports.FindByRequestedTripHandler=exports.FindByConfirmedTripHandler=exports.FindByPassengerHandler=exports.FindByDriverHandler=exports.FindAllHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(5621),cqrs_1=__webpack_require__(4628),trips_query_query_1=__webpack_require__(1684);let FindAllHandler=class FindAllHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findAll()}))}};FindAllHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindAllQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_a:Object])],FindAllHandler),exports.FindAllHandler=FindAllHandler;let FindByDriverHandler=class FindByDriverHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByDriver(query.driverId)}))}};FindByDriverHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindByDriverQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_b:Object])],FindByDriverHandler),exports.FindByDriverHandler=FindByDriverHandler;let FindByPassengerHandler=class FindByPassengerHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByPassenger(query.passengerId)}))}};FindByPassengerHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindByPassengerQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_c:Object])],FindByPassengerHandler),exports.FindByPassengerHandler=FindByPassengerHandler;let FindByConfirmedTripHandler=class FindByConfirmedTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByConfirmedTrips(query.passengerId)}))}};FindByConfirmedTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.findByConfirmedTripsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_d:Object])],FindByConfirmedTripHandler),exports.FindByConfirmedTripHandler=FindByConfirmedTripHandler;let FindByRequestedTripHandler=class FindByRequestedTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByRequestedTrips(query.passengerId)}))}};FindByRequestedTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.findByRequestedTripsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_e:Object])],FindByRequestedTripHandler),exports.FindByRequestedTripHandler=FindByRequestedTripHandler;let FindBookingByTripHandler=class FindBookingByTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findBookingByTrip(query.tripId)}))}};FindBookingByTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindBookingByTripQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_f:Object])],FindBookingByTripHandler),exports.FindBookingByTripHandler=FindBookingByTripHandler;let FindBookingByTripAndUserIdHandler=class FindBookingByTripAndUserIdHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findBookingByTripAndUserId(query.tripId,query.userId)}))}};FindBookingByTripAndUserIdHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindBookingByTripAndUserIdQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_g=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_g:Object])],FindBookingByTripAndUserIdHandler),exports.FindBookingByTripAndUserIdHandler=FindBookingByTripAndUserIdHandler;let FindCoordinatesByTripHandler=class FindCoordinatesByTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findCoordinatesByTrip(query.tripId)}))}};FindCoordinatesByTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindCoordinatesByTripQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_h:Object])],FindCoordinatesByTripHandler),exports.FindCoordinatesByTripHandler=FindCoordinatesByTripHandler;let FindTripByIdHandler=class FindTripByIdHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findTripById(query.tripId)}))}};FindTripByIdHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindTripByIdQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_j=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_j:Object])],FindTripByIdHandler),exports.FindTripByIdHandler=FindTripByIdHandler;let SearchTripsHandler=class SearchTripsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.searchTrips(query.date)}))}};SearchTripsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.SearchTripsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_k=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_k:Object])],SearchTripsHandler),exports.SearchTripsHandler=SearchTripsHandler;let FindAllTripRequestsHandler=class FindAllTripRequestsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findAllTripRequests(query.userId)}))}};FindAllTripRequestsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindAllTripRequestsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_l=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_l:Object])],FindAllTripRequestsHandler),exports.FindAllTripRequestsHandler=FindAllTripRequestsHandler},1684:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindAllTripRequestsQuery=exports.SearchTripsQuery=exports.FindTripByIdQuery=exports.FindCoordinatesByTripQuery=exports.FindBookingByTripAndUserIdQuery=exports.FindBookingByTripQuery=exports.findByRequestedTripsQuery=exports.findByConfirmedTripsQuery=exports.FindByPassengerQuery=exports.FindByDriverQuery=exports.FindAllQuery=void 0;exports.FindAllQuery=class FindAllQuery{};exports.FindByDriverQuery=class FindByDriverQuery{constructor(driverId){this.driverId=driverId}};exports.FindByPassengerQuery=class FindByPassengerQuery{constructor(passengerId){this.passengerId=passengerId}};exports.findByConfirmedTripsQuery=class findByConfirmedTripsQuery{constructor(passengerId){this.passengerId=passengerId}};exports.findByRequestedTripsQuery=class findByRequestedTripsQuery{constructor(passengerId){this.passengerId=passengerId}};exports.FindBookingByTripQuery=class FindBookingByTripQuery{constructor(tripId){this.tripId=tripId}};exports.FindBookingByTripAndUserIdQuery=class FindBookingByTripAndUserIdQuery{constructor(tripId,userId){this.tripId=tripId,this.userId=userId}};exports.FindCoordinatesByTripQuery=class FindCoordinatesByTripQuery{constructor(tripId){this.tripId=tripId}};exports.FindTripByIdQuery=class FindTripByIdQuery{constructor(tripId){this.tripId=tripId}};exports.SearchTripsQuery=class SearchTripsQuery{constructor(date){this.date=date}};exports.FindAllTripRequestsQuery=class FindAllTripRequestsQuery{constructor(userId){this.userId=userId}}},2285:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),trips_query_query_1=__webpack_require__(1684),trips_command_command_1=__webpack_require__(7577);let TripsService=class TripsService{constructor(queryBus,commandBus){this.queryBus=queryBus,this.commandBus=commandBus}findAll(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindAllQuery)}))}findTripById(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindTripByIdQuery(tripId))}))}findByDriver(driverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindByDriverQuery(driverId))}))}findByPassenger(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindByPassengerQuery(passengerId))}))}findByConfirmedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.findByConfirmedTripsQuery(passengerId))}))}findByRequestedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.findByRequestedTripsQuery(passengerId))}))}findBookingByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindBookingByTripQuery(tripID))}))}findBookingByTripAndUserId(tripID,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindBookingByTripAndUserIdQuery(tripID,userId))}))}findCoordinatesByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindCoordinatesByTripQuery(tripID))}))}searchTrips(date){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.SearchTripsQuery(date))}))}create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.TripsCreateCommand(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude))}))}bookTrip(passengerId,tripId,seatsBooked,status,price,address,latitude,longitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.BookTripCommand(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude))}))}update(tripId,seatsAvailable,price,status){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.TripsUpdateCommand(tripId,seatsAvailable,price,status))}))}updatePaymentStatus(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.BookingUpdatePaymentStatusCommand(bookingId))}))}delete(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.TripsDeleteCommand(tripId))}))}acceptTripRequest(tripId,bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.AcceptTripRequestCommand(tripId,bookingId))}))}declineTripRequest(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.DeclineTripRequestCommand(bookingId))}))}startTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.StartTripCommand(tripId))}))}endTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.EndTripCommand(tripId))}))}findAllTripRequests(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindAllTripRequestsQuery(userId))}))}};TripsService=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==cqrs_1.QueryBus&&cqrs_1.QueryBus)?_a:Object,"function"==typeof(_b=void 0!==cqrs_1.CommandBus&&cqrs_1.CommandBus)?_b:Object])],TripsService),exports.TripsService=TripsService},6945:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(7435),exports),tslib_1.__exportStar(__webpack_require__(350),exports)},7435:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.WeatherModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),weather_resolver_resolver_1=__webpack_require__(350);let WeatherModule=class WeatherModule{};WeatherModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[weather_resolver_resolver_1.WeatherResolver],exports:[]})],WeatherModule),exports.WeatherModule=WeatherModule},350:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.WeatherResolver=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(4725),axios_1=__webpack_require__(2167);let WeatherResolver=class WeatherResolver{getWeather(lat,long){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const location=yield axios_1.default.get(`http://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey=ZLZ7t3NgGRDKOaXMKZshgK0Gf2UAyv5m&q=${lat}%2C${long}`),conditions=yield axios_1.default.get(`http://dataservice.accuweather.com/currentconditions/v1/${location.data.Key}?apikey=ZLZ7t3NgGRDKOaXMKZshgK0Gf2UAyv5m&details=true`),result={isRaining:!1,isWindy:!1,windSpeed:`${conditions.data[0].Wind.Speed.Metric.Value}km/h`,isSnowing:!1,temperature:`${conditions.data[0].Temperature.Metric.Value}°C`};return conditions.data[0].HasPrecipitation&&("Rain"===conditions.data[0].PrecipitationType&&(result.isRaining=!0),"Snow"===conditions.data[0].PrecipitationType&&(result.isSnowing=!0)),conditions.data[0].Wind.Speed.Metric.Value>30&&(result.isWindy=!0),result}))}};tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.Weather)),tslib_1.__param(0,(0,graphql_1.Args)("lat")),tslib_1.__param(1,(0,graphql_1.Args)("long")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_a="undefined"!=typeof Promise&&Promise)?_a:Object)],WeatherResolver.prototype,"getWeather",null),WeatherResolver=tslib_1.__decorate([(0,graphql_1.Resolver)()],WeatherResolver),exports.WeatherResolver=WeatherResolver},4725:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(3651),exports),tslib_1.__exportStar(__webpack_require__(1157),exports)},3651:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiWeatherApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiWeatherApiSharedEntitiesDataAccessModule=class ApiWeatherApiSharedEntitiesDataAccessModule{};ApiWeatherApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiWeatherApiSharedEntitiesDataAccessModule),exports.ApiWeatherApiSharedEntitiesDataAccessModule=ApiWeatherApiSharedEntitiesDataAccessModule},1157:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.Weather=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161);let Weather=class Weather{};tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],Weather.prototype,"isRaining",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],Weather.prototype,"isWindy",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Weather.prototype,"windSpeed",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],Weather.prototype,"isSnowing",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Weather.prototype,"temperature",void 0),Weather=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Weather),exports.Weather=Weather},2138:module=>{module.exports=require("@nestjs-modules/mailer")},2498:module=>{module.exports=require("@nestjs-modules/mailer/dist/adapters/handlebars.adapter")},9096:module=>{module.exports=require("@nestjs/apollo")},6481:module=>{module.exports=require("@nestjs/common")},5793:module=>{module.exports=require("@nestjs/config")},143:module=>{module.exports=require("@nestjs/core")},4628:module=>{module.exports=require("@nestjs/cqrs")},1161:module=>{module.exports=require("@nestjs/graphql")},3524:module=>{module.exports=require("@prisma/client")},2167:module=>{module.exports=require("axios")},7096:module=>{module.exports=require("bcrypt")},1283:module=>{module.exports=require("graphql-subscriptions")},752:module=>{module.exports=require("tslib")},1017:module=>{module.exports=require("path")}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}var __webpack_exports__={};(()=>{var exports=__webpack_exports__;Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),core_1=__webpack_require__(143),app_module_1=__webpack_require__(3292);!function(){tslib_1.__awaiter(this,void 0,void 0,(function*(){const app=yield core_1.NestFactory.create(app_module_1.AppModule);app.setGlobalPrefix("api");const port=process.env.PORT||3333;yield app.listen(port),common_1.Logger.log(`🚀 Application is running on: http://localhost:${port}/api`)}))}()})();var __webpack_export_target__=exports;for(var i in __webpack_exports__)__webpack_export_target__[i]=__webpack_exports__[i];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();
//# sourceMappingURL=main.js.map