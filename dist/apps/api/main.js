(()=>{"use strict";var __webpack_modules__={6454:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppController=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),app_service_1=__webpack_require__(8968);let AppController=class AppController{constructor(appService){this.appService=appService}getData(){return this.appService.getData()}create(request,response){return tslib_1.__awaiter(this,void 0,void 0,(function*(){try{yield this.appService.fileupload(request,response)}catch(error){return response.status(500).json(`Failed to upload image file: ${error.message}`)}}))}getImage(request,response,params){return tslib_1.__awaiter(this,void 0,void 0,(function*(){try{yield this.appService.getImage(request,response,params)}catch(error){return response.status(500).json(`Failed to upload image file: ${error.message}`)}}))}};tslib_1.__decorate([(0,common_1.Get)(),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype",void 0)],AppController.prototype,"getData",null),tslib_1.__decorate([(0,common_1.Post)(),tslib_1.__param(0,(0,common_1.Req)()),tslib_1.__param(1,(0,common_1.Res)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[Object,Object]),tslib_1.__metadata("design:returntype",Promise)],AppController.prototype,"create",null),tslib_1.__decorate([(0,common_1.Get)(":key"),tslib_1.__param(0,(0,common_1.Req)()),tslib_1.__param(1,(0,common_1.Res)()),tslib_1.__param(2,(0,common_1.Param)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[Object,Object,Object]),tslib_1.__metadata("design:returntype",Promise)],AppController.prototype,"getImage",null),AppController=tslib_1.__decorate([(0,common_1.Controller)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==app_service_1.AppService&&app_service_1.AppService)?_a:Object])],AppController),exports.AppController=AppController},3292:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),shell_1=__webpack_require__(2140),config_1=__webpack_require__(5793),mailer_1=__webpack_require__(2138),path_1=__webpack_require__(1017),handlebars_adapter_1=__webpack_require__(2498),app_controller_1=__webpack_require__(6454),app_service_1=__webpack_require__(8968);let AppModule=class AppModule{};AppModule=tslib_1.__decorate([(0,common_1.Module)({imports:[shell_1.ApiShellFeatureModule,app_service_1.AppService,mailer_1.MailerModule.forRootAsync({imports:[config_1.ConfigModule],useFactory:config=>tslib_1.__awaiter(void 0,void 0,void 0,(function*(){return{transport:{host:config.get("EMAIL_HOST"),secure:!1,auth:{user:config.get("EMAIL_USER"),pass:config.get("EMAIL_PASSWORD")}},defaults:{from:"blulancetech@gmail.com"},template:{dir:(0,path_1.join)(__dirname,"./mail_templates"),adapter:new handlebars_adapter_1.HandlebarsAdapter,options:{strict:!0}}}})),inject:[config_1.ConfigService]}),config_1.ConfigModule.forRoot()],controllers:[app_controller_1.AppController],providers:[app_service_1.AppService]})],AppModule),exports.AppModule=AppModule},8968:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),S3=__webpack_require__(7212),multer=__webpack_require__(1738),multerS3=__webpack_require__(2776),client_s3_1=__webpack_require__(1841),AWS_S3_BUCKET_NAME=process.env.AWS_S3_BUCKET_NAME,s3Client=new client_s3_1.S3Client({region:"eu-west-3",credentials:{accessKeyId:process.env.AWS_ACCESS_KEY,secretAccessKey:process.env.AWS_SECRET_KEY}}),s3=new S3({region:"eu-west-3",credentials:{accessKeyId:process.env.AWS_ACCESS_KEY,secretAccessKey:process.env.AWS_SECRET_KEY}});let AppService=class AppService{constructor(){this.upload=multer({storage:multerS3({s3:s3Client,bucket:AWS_S3_BUCKET_NAME,contentType:multerS3.AUTO_CONTENT_TYPE,filename:function(req,file,cb){file.originalname.includes(".image")&&file.originalname.replace(".image",".png"),cb(null,(new Date).toISOString()+file.originalname)}})}).array("upload",1),this.getFileStream=fileKey=>{const downloadParams={Key:fileKey,Bucket:AWS_S3_BUCKET_NAME};try{return s3.getObject(downloadParams).createReadStream()}catch(error){console.log("error: ",error)}}}getData(){return{message:"Welcome to api!"}}getImage(req,res,params){return tslib_1.__awaiter(this,void 0,void 0,(function*(){try{const key=params.key;this.getFileStream(key).pipe(res)}catch(err){res.status(500).send(err)}}))}fileupload(req,res){return tslib_1.__awaiter(this,void 0,void 0,(function*(){try{this.upload(req,res,(function(error){return error?(console.log(error),res.status(404).json(`Failed to upload image file: ${error}`)):(console.log(req.files[0]),res.status(201).json(req.files[0]))}))}catch(error){return console.log(error),res.status(500).json(`Failed to upload image file: ${error}`)}}))}};tslib_1.__decorate([tslib_1.__param(0,(0,common_1.Req)()),tslib_1.__param(1,(0,common_1.Res)()),tslib_1.__param(2,(0,common_1.Param)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[Object,Object,Object]),tslib_1.__metadata("design:returntype",Promise)],AppService.prototype,"getImage",null),tslib_1.__decorate([tslib_1.__param(0,(0,common_1.Req)()),tslib_1.__param(1,(0,common_1.Res)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[Object,Object]),tslib_1.__metadata("design:returntype",Promise)],AppService.prototype,"fileupload",null),AppService=tslib_1.__decorate([(0,common_1.Injectable)()],AppService),exports.AppService=AppService},8321:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(7966),exports)},7966:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthenticationModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),repository_1=__webpack_require__(4255),service_1=__webpack_require__(9029),auth_resolver_resolver_1=__webpack_require__(9988),service_2=__webpack_require__(9029),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_3=__webpack_require__(5336),service_4=__webpack_require__(4071);let AuthenticationModule=class AuthenticationModule{};AuthenticationModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[auth_resolver_resolver_1.AuthResolver,service_1.AuthService,service_3.DriversService,service_2.DriverRegisterHandler,service_2.AdminLoginHandler,service_4.TripsService,service_2.UpdateUserImageHandler,service_2.FindTopUsersHandler,service_2.FindAllUsersHandler,service_2.FindTotalDriversHandler,service_2.FindTotalUsersHandler,service_2.FindTopUniversitiesHandler,service_2.FindRecentUsersHandler,service_2.ResetPasswordHandler,service_2.ForgotPasswordHandler,prisma_1.PrismaService,service_2.UserLoginHandler,service_2.UserUpdateHandler,service_2.UserRegisterHandler,service_1.UserVerifyHandler,repository_1.AuthRepository,service_1.FindUserByIdHandler]})],AuthenticationModule),exports.AuthenticationModule=AuthenticationModule},9988:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthResolver=void 0;const tslib_1=__webpack_require__(752),service_1=__webpack_require__(9029),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(3265),service_2=__webpack_require__(5336),service_3=__webpack_require__(4071),entities_2=__webpack_require__(8095);let AuthResolver=class AuthResolver{constructor(authService,driversService,tripsService){this.authService=authService,this.driversService=driversService,this.tripsService=tripsService}tripsCreated(user){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByDriver(user.id)}))}bookings(user){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingsByUser(user.id)}))}driver(user){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.driversService.findDriverProfile(user.id)}))}updateUserImage(id,image){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.updateUserImage(id,image)}))}findUserById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(id)}))}findTopUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findTopUsers()}))}findAllUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findAllUsers()}))}findTotalUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findTotalUsers()}))}findTotalDrivers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findTotalDrivers()}))}findRecentUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findRecentUsers()}))}findTopUniversities(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findTopUniversities()}))}login(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const userObj=yield this.authService.login(email,password);if(userObj){const user=new entities_1.UserLogin;return user.id=userObj.id,user.email=userObj.email,user.isDriver=userObj.isDriver,userObj.isValidated?user.token="generate":user.token="",user}throw new Error("Invalid credentials")}))}adminLogin(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const userObj=yield this.authService.adminLogin(email,password);if(userObj){const user=new entities_1.AdminUserReturn;return user.id=userObj.id,user.email=userObj.email,user.name=userObj.name,user.surname=userObj.surname,user}throw new Error("Invalid credentials")}))}register(name,surname,email,university,studentNumber,password,cellNumber){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const userObj=yield this.authService.register(name,surname,email,university,studentNumber,password,cellNumber);if(userObj){const user=new entities_1.UserLogin;user.id=userObj.id,user.email=userObj.email,user.verificationCode=`${Math.floor(1e5+9e5*Math.random())}`;const date=new Date;return date.setDate(date.getDate()+1),user.expires=date,console.log("before email"),yield this.authService.sendVerificationEmail(user.email,user.verificationCode),console.log("after email"),user}throw new Error("Something went wrong!")}))}forgotPassword(email){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const userObj=yield this.authService.forgotPassword(email);if(userObj){const user=new entities_1.ForgotPassword;user.email=userObj.email,user.verificationCode=`${Math.floor(1e5+9e5*Math.random())}`;const date=new Date;return date.setDate(date.getDate()+1),user.expires=date,console.log("before email"),yield this.authService.sendVerificationEmail(user.email,user.verificationCode),console.log("after email"),user}throw new Error("Something went wrong!")}))}resetPassword(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.resetPassword(email,password)}))}registerDriver(ID,licensePlate,carModel,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const driverObj=yield this.authService.registerDriver(userId,licensePlate,carModel,ID);if(driverObj)return driverObj;throw new Error("Something went wrong!")}))}verifyEmail(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.verifyEmail(id)}))}updateUser(id,name,surname,email,university,studentNumber,cellNumber){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.updateUser(id,name,surname,email,university,studentNumber,cellNumber)}))}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==entities_1.User&&entities_1.User)?_d:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_e="undefined"!=typeof Promise&&Promise)?_e:Object)],AuthResolver.prototype,"tripsCreated",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>[entities_2.Booking])),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==entities_1.User&&entities_1.User)?_f:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_g="undefined"!=typeof Promise&&Promise)?_g:Object)],AuthResolver.prototype,"bookings",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_1.Driver)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==entities_1.User&&entities_1.User)?_h:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_j="undefined"!=typeof Promise&&Promise)?_j:Object)],AuthResolver.prototype,"driver",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__param(1,(0,graphql_1.Args)("image")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_k="undefined"!=typeof Promise&&Promise)?_k:Object)],AuthResolver.prototype,"updateUserImage",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_l="undefined"!=typeof Promise&&Promise)?_l:Object)],AuthResolver.prototype,"findUserById",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_1.User])),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_m="undefined"!=typeof Promise&&Promise)?_m:Object)],AuthResolver.prototype,"findTopUsers",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_1.User])),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_o="undefined"!=typeof Promise&&Promise)?_o:Object)],AuthResolver.prototype,"findAllUsers",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>Number)),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_p="undefined"!=typeof Promise&&Promise)?_p:Object)],AuthResolver.prototype,"findTotalUsers",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>Number)),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_q="undefined"!=typeof Promise&&Promise)?_q:Object)],AuthResolver.prototype,"findTotalDrivers",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_1.User])),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_r="undefined"!=typeof Promise&&Promise)?_r:Object)],AuthResolver.prototype,"findRecentUsers",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_1.TopUniversities])),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_s="undefined"!=typeof Promise&&Promise)?_s:Object)],AuthResolver.prototype,"findTopUniversities",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.UserLogin)),tslib_1.__param(0,(0,graphql_1.Args)("email")),tslib_1.__param(1,(0,graphql_1.Args)("password")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_t="undefined"!=typeof Promise&&Promise)?_t:Object)],AuthResolver.prototype,"login",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.AdminUserReturn)),tslib_1.__param(0,(0,graphql_1.Args)("email")),tslib_1.__param(1,(0,graphql_1.Args)("password")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_u="undefined"!=typeof Promise&&Promise)?_u:Object)],AuthResolver.prototype,"adminLogin",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.UserLogin)),tslib_1.__param(0,(0,graphql_1.Args)("name")),tslib_1.__param(1,(0,graphql_1.Args)("surname")),tslib_1.__param(2,(0,graphql_1.Args)("email")),tslib_1.__param(3,(0,graphql_1.Args)("university")),tslib_1.__param(4,(0,graphql_1.Args)("studentNumber")),tslib_1.__param(5,(0,graphql_1.Args)("password")),tslib_1.__param(6,(0,graphql_1.Args)("cellNumber")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_v="undefined"!=typeof Promise&&Promise)?_v:Object)],AuthResolver.prototype,"register",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.ForgotPassword)),tslib_1.__param(0,(0,graphql_1.Args)("email")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_w="undefined"!=typeof Promise&&Promise)?_w:Object)],AuthResolver.prototype,"forgotPassword",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Args)("email")),tslib_1.__param(1,(0,graphql_1.Args)("password")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype",Promise)],AuthResolver.prototype,"resetPassword",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.Driver)),tslib_1.__param(0,(0,graphql_1.Args)("ID")),tslib_1.__param(1,(0,graphql_1.Args)("licensePlate")),tslib_1.__param(2,(0,graphql_1.Args)("carModel")),tslib_1.__param(3,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_x="undefined"!=typeof Promise&&Promise)?_x:Object)],AuthResolver.prototype,"registerDriver",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>Boolean)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_y="undefined"!=typeof Promise&&Promise)?_y:Object)],AuthResolver.prototype,"verifyEmail",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__param(1,(0,graphql_1.Args)("name")),tslib_1.__param(2,(0,graphql_1.Args)("surname")),tslib_1.__param(3,(0,graphql_1.Args)("email")),tslib_1.__param(4,(0,graphql_1.Args)("university")),tslib_1.__param(5,(0,graphql_1.Args)("studentNumber")),tslib_1.__param(6,(0,graphql_1.Args)("cellNumber")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_z="undefined"!=typeof Promise&&Promise)?_z:Object)],AuthResolver.prototype,"updateUser",null),AuthResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_1.User)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==service_1.AuthService&&service_1.AuthService)?_a:Object,"function"==typeof(_b=void 0!==service_2.DriversService&&service_2.DriversService)?_b:Object,"function"==typeof(_c=void 0!==service_3.TripsService&&service_3.TripsService)?_c:Object])],AuthResolver),exports.AuthResolver=AuthResolver},3265:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(9004),exports),tslib_1.__exportStar(__webpack_require__(3176),exports)},9004:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiAuthenticationApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiAuthenticationApiSharedEntitiesDataAccessModule=class ApiAuthenticationApiSharedEntitiesDataAccessModule{};ApiAuthenticationApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiAuthenticationApiSharedEntitiesDataAccessModule),exports.ApiAuthenticationApiSharedEntitiesDataAccessModule=ApiAuthenticationApiSharedEntitiesDataAccessModule},3176:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j;Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserUpdate=exports.ForgotPassword=exports.Driver=exports.DriverInput=exports.UserInput=exports.UserLogin=exports.TopUniversities=exports.Count=exports.UserReturn=exports.User=exports.AdminUserReturn=exports.Upload=exports.AdminUser=void 0;const tslib_1=__webpack_require__(752),entities_1=__webpack_require__(8095),graphql_1=__webpack_require__(1161),stream_1=__webpack_require__(2781);let AdminUser=class AdminUser{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],AdminUser.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AdminUser.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AdminUser.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AdminUser.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AdminUser.prototype,"password",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_a="undefined"!=typeof Date&&Date)?_a:Object)],AdminUser.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_b="undefined"!=typeof Date&&Date)?_b:Object)],AdminUser.prototype,"updatedAt",void 0),AdminUser=tslib_1.__decorate([(0,graphql_1.ObjectType)()],AdminUser),exports.AdminUser=AdminUser;let Upload=class Upload{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Upload.prototype,"filename",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Upload.prototype,"mimetype",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Upload.prototype,"encoding",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>stream_1.Stream)),tslib_1.__metadata("design:type","function"==typeof(_c=void 0!==stream_1.Stream&&stream_1.Stream)?_c:Object)],Upload.prototype,"createReadStream",void 0),Upload=tslib_1.__decorate([(0,graphql_1.InputType)()],Upload),exports.Upload=Upload;let AdminUserReturn=class AdminUserReturn{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],AdminUserReturn.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AdminUserReturn.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AdminUserReturn.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AdminUserReturn.prototype,"surname",void 0),AdminUserReturn=tslib_1.__decorate([(0,graphql_1.ObjectType)()],AdminUserReturn),exports.AdminUserReturn=AdminUserReturn;let User=class User{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],User.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"password",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"studentNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"profilePic",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],User.prototype,"isDriver",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_d="undefined"!=typeof Date&&Date)?_d:Object)],User.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_e="undefined"!=typeof Date&&Date)?_e:Object)],User.prototype,"updatedAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Number)),tslib_1.__metadata("design:type",Number)],User.prototype,"avgRating",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],User.prototype,"cellNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],User.prototype,"isValidated",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[entities_1.Trip])),tslib_1.__metadata("design:type",Array)],User.prototype,"tripsCreated",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[entities_1.Booking])),tslib_1.__metadata("design:type",Array)],User.prototype,"bookings",void 0),User=tslib_1.__decorate([(0,graphql_1.ObjectType)()],User),exports.User=User;let UserReturn=class UserReturn{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"studentNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"profilePic",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],UserReturn.prototype,"isDriver",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_f="undefined"!=typeof Date&&Date)?_f:Object)],UserReturn.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_g="undefined"!=typeof Date&&Date)?_g:Object)],UserReturn.prototype,"updatedAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Number)),tslib_1.__metadata("design:type",Number)],UserReturn.prototype,"avgRating",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserReturn.prototype,"cellNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],UserReturn.prototype,"isValidated",void 0),UserReturn=tslib_1.__decorate([(0,graphql_1.ObjectType)()],UserReturn),exports.UserReturn=UserReturn;let Count=class Count{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",Number)],Count.prototype,"university",void 0),Count=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Count),exports.Count=Count;let TopUniversities=class TopUniversities{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TopUniversities.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Count)),tslib_1.__metadata("design:type",Count)],TopUniversities.prototype,"_count",void 0),TopUniversities=tslib_1.__decorate([(0,graphql_1.ObjectType)()],TopUniversities),exports.TopUniversities=TopUniversities;let UserLogin=class UserLogin{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],UserLogin.prototype,"isDriver",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"token",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserLogin.prototype,"verificationCode",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_h="undefined"!=typeof Date&&Date)?_h:Object)],UserLogin.prototype,"expires",void 0),UserLogin=tslib_1.__decorate([(0,graphql_1.ObjectType)()],UserLogin),exports.UserLogin=UserLogin;let UserInput=class UserInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"password",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"cellNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserInput.prototype,"studentNumber",void 0),UserInput=tslib_1.__decorate([(0,graphql_1.InputType)()],UserInput),exports.UserInput=UserInput;let DriverInput=class DriverInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"ID",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"licensePlate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],DriverInput.prototype,"carModel",void 0),DriverInput=tslib_1.__decorate([(0,graphql_1.InputType)()],DriverInput),exports.DriverInput=DriverInput;let Driver=class Driver{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"idNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"license",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"licensePlate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"model",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Driver.prototype,"carPicture",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>User)),tslib_1.__metadata("design:type",User)],Driver.prototype,"user",void 0),Driver=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Driver),exports.Driver=Driver;let ForgotPassword=class ForgotPassword{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ForgotPassword.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ForgotPassword.prototype,"verificationCode",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_j="undefined"!=typeof Date&&Date)?_j:Object)],ForgotPassword.prototype,"expires",void 0),ForgotPassword=tslib_1.__decorate([(0,graphql_1.ObjectType)()],ForgotPassword),exports.ForgotPassword=ForgotPassword;let UserUpdate=class UserUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"name",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"surname",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"cellNumber",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"email",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"university",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],UserUpdate.prototype,"studentNumber",void 0),UserUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],UserUpdate),exports.UserUpdate=UserUpdate},4255:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(7494),exports),tslib_1.__exportStar(__webpack_require__(5042),exports)},7494:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiAuthenticationRepositoryDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiAuthenticationRepositoryDataAccessModule=class ApiAuthenticationRepositoryDataAccessModule{};ApiAuthenticationRepositoryDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiAuthenticationRepositoryDataAccessModule),exports.ApiAuthenticationRepositoryDataAccessModule=ApiAuthenticationRepositoryDataAccessModule},5042:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthRepository=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),prisma_1=__webpack_require__(6432),bcrypt=__webpack_require__(7096);let AuthRepository=class AuthRepository{constructor(prisma){this.prisma=prisma}findUserById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.user.findUnique({where:{id}})}))}updateUserImage(id,image){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const user=yield this.prisma.user.update({where:{id},data:{profilePic:image}});if(user)return user;throw new Error(`User with id ${id} does not exist`)}))}findTotalUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.user.count()}))}findTopUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.user.findMany({orderBy:{avgRating:"desc"},take:5})}))}findTopUniversities(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.user.groupBy({by:["university"],_count:{university:!0},orderBy:{_count:{university:"desc"}}})}))}findTotalDrivers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.driver.count()}))}findAllUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.user.findMany()}))}findRecentUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.user.findMany({orderBy:{createdAt:"desc"},take:5})}))}findAllDrivers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.user.findMany({where:{isDriver:!0}})}))}login(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const user=yield this.prisma.user.findUnique({where:{email}});if(user&&user.isValidated){if(yield bcrypt.compare(password,user.password))return user}else{if(!user)throw new common_1.NotFoundException(`User with email ${email} does not exist`);if(!user.isValidated)throw new common_1.UnauthorizedException("Email address has not been validated")}}))}adminLogin(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const user=yield this.prisma.adminUser.findUnique({where:{email}});if(user){if(yield bcrypt.compare(password,user.password))return user}else if(!user)throw new common_1.NotFoundException(`User with email ${email} does not exist`)}))}register(user){return tslib_1.__awaiter(this,void 0,void 0,(function*(){if(yield this.prisma.user.findUnique({where:{email:user.email}}))throw new Error(`User with email ${user.email} already exists`);{const salt=yield bcrypt.genSalt(),hashedPassword=yield bcrypt.hash(user.password,salt);return this.prisma.user.create({data:{name:user.name,surname:user.surname,email:user.email,university:user.university,studentNumber:user.studentNumber,password:hashedPassword,cellNumber:user.cellNumber,profilePic:""}})}}))}forgotPassword(email){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const user=yield this.prisma.user.findUnique({where:{email}});if(user)return user;throw new Error(`User with email ${email} does not exist`)}))}resetPassword(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const salt=yield bcrypt.genSalt(),hashedPassword=yield bcrypt.hash(password,salt),user=yield this.prisma.user.update({where:{email},data:{password:hashedPassword}});if(user)return user;throw new Error(`User with email ${email} does not exist`)}))}registerDriver(driver){return tslib_1.__awaiter(this,void 0,void 0,(function*(){if(yield this.prisma.driver.findUnique({where:{userId:driver.userId}}))throw new Error("User with already registered as driver");{const driverCreated=yield this.prisma.driver.create({data:{idNumber:driver.ID,licensePlate:driver.licensePlate,model:driver.carModel,userId:driver.userId,license:"",carPicture:""}});return yield this.prisma.user.update({where:{id:driver.userId},data:{isDriver:!0}}),driverCreated}}))}validateEmail(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return!!(yield this.prisma.user.update({where:{id},data:{isValidated:!0}}))}))}updateUser(user){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const updatedUser=yield this.prisma.user.update({where:{id:user.id},data:{name:user.name,surname:user.surname,email:user.email,university:user.university,studentNumber:user.studentNumber,cellNumber:user.cellNumber}});if(updatedUser)return updatedUser}))}};AuthRepository=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_a:Object])],AuthRepository),exports.AuthRepository=AuthRepository},9029:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(6191),exports),tslib_1.__exportStar(__webpack_require__(8764),exports),tslib_1.__exportStar(__webpack_require__(3604),exports),tslib_1.__exportStar(__webpack_require__(7875),exports)},6191:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiAuthenticationServiceFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiAuthenticationServiceFeatureModule=class ApiAuthenticationServiceFeatureModule{};ApiAuthenticationServiceFeatureModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiAuthenticationServiceFeatureModule),exports.ApiAuthenticationServiceFeatureModule=ApiAuthenticationServiceFeatureModule},8764:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),auth_query_query_1=__webpack_require__(1891),auth_command_command_1=__webpack_require__(5614),mailer_1=__webpack_require__(2138);let AuthService=class AuthService{constructor(queryBus,commandBus,mailerService){this.queryBus=queryBus,this.commandBus=commandBus,this.mailerService=mailerService}findUserById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new auth_query_query_1.FindUserByIdQuery(id))}))}login(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new auth_query_query_1.UserLoginQuery(email,password))}))}adminLogin(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new auth_query_query_1.AdminLoginQuery(email,password))}))}findTopUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new auth_query_query_1.FindTopUsersQuery)}))}findTotalUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.queryBus.execute(new auth_query_query_1.FindTotalUsersQuery)}))}findAllUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.queryBus.execute(new auth_query_query_1.FindAllUsersQuery)}))}findTotalDrivers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.queryBus.execute(new auth_query_query_1.FindTotalDriversQuery)}))}findRecentUsers(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.queryBus.execute(new auth_query_query_1.FindRecentUsersQuery)}))}findTopUniversities(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.queryBus.execute(new auth_query_query_1.FindTopUniversitiesQuery)}))}register(name,surname,email,university,studentNumber,password,cellNumber){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.UserRegisterCommand(name,surname,email,university,studentNumber,password,cellNumber))}))}forgotPassword(email){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new auth_query_query_1.ForgotPasswordQuery(email))}))}registerDriver(ID,licensePlate,carModel,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.DriverRegisterCommand(userId,licensePlate,carModel,ID))}))}verifyEmail(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.UserVerifyCommand(id))}))}sendVerificationEmail(email,code){return tslib_1.__awaiter(this,void 0,void 0,(function*(){yield this.mailerService.sendMail({to:email,subject:"Greeting from NestJS NodeMailer",template:"/confirm_email",context:{code}})}))}updateUser(id,name,surname,email,university,studentNumber,cellNumber){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.UserUpdateCommand(id,name,surname,email,university,studentNumber,cellNumber))}))}updateUserImage(id,image){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.UpdateUserImageCommand(id,image))}))}resetPassword(email,password){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new auth_command_command_1.ResetPasswordCommand(email,password))}))}};AuthService=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==cqrs_1.QueryBus&&cqrs_1.QueryBus)?_a:Object,"function"==typeof(_b=void 0!==cqrs_1.CommandBus&&cqrs_1.CommandBus)?_b:Object,"function"==typeof(_c=void 0!==mailer_1.MailerService&&mailer_1.MailerService)?_c:Object])],AuthService),exports.AuthService=AuthService},7875:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResetPasswordHandler=exports.UpdateUserImageHandler=exports.UserUpdateHandler=exports.UserVerifyHandler=exports.DriverRegisterHandler=exports.UserRegisterHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(4255),cqrs_1=__webpack_require__(4628),auth_command_command_1=__webpack_require__(5614),entities_1=__webpack_require__(3265);let UserRegisterHandler=class UserRegisterHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{name,surname,email,university,studentNumber,password,cellNumber}=command,user=new entities_1.UserInput;return user.name=name,user.surname=surname,user.email=email,user.university=university,user.studentNumber=studentNumber,user.password=password,user.cellNumber=cellNumber,yield this.authRepository.register(user)}))}};UserRegisterHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.UserRegisterCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_a:Object])],UserRegisterHandler),exports.UserRegisterHandler=UserRegisterHandler;let DriverRegisterHandler=class DriverRegisterHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{userId,licensePlate,carModel,ID}=command,driver=new entities_1.DriverInput;return driver.userId=userId,driver.licensePlate=licensePlate,driver.carModel=carModel,driver.ID=ID,yield this.authRepository.registerDriver(driver)}))}};DriverRegisterHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.DriverRegisterCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_b:Object])],DriverRegisterHandler),exports.DriverRegisterHandler=DriverRegisterHandler;let UserVerifyHandler=class UserVerifyHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{id}=command;return yield this.authRepository.validateEmail(id)}))}};UserVerifyHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.UserVerifyCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_c:Object])],UserVerifyHandler),exports.UserVerifyHandler=UserVerifyHandler;let UserUpdateHandler=class UserUpdateHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{id,name,surname,email,university,studentNumber,cellNumber}=command,user=new entities_1.UserUpdate;return user.id=id,user.name=name,user.surname=surname,user.email=email,user.university=university,user.studentNumber=studentNumber,user.cellNumber=cellNumber,yield this.authRepository.updateUser(user)}))}};UserUpdateHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.UserUpdateCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_d:Object])],UserUpdateHandler),exports.UserUpdateHandler=UserUpdateHandler;let UpdateUserImageHandler=class UpdateUserImageHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.updateUserImage(command.id,command.image)}))}};UpdateUserImageHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.UpdateUserImageCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_e:Object])],UpdateUserImageHandler),exports.UpdateUserImageHandler=UpdateUserImageHandler;let ResetPasswordHandler=class ResetPasswordHandler{constructor(authRepository){this.authRepository=authRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{email,password}=command;return yield this.authRepository.resetPassword(email,password)}))}};ResetPasswordHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(auth_command_command_1.ResetPasswordCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_f:Object])],ResetPasswordHandler),exports.ResetPasswordHandler=ResetPasswordHandler},5614:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateUserImageCommand=exports.ResetPasswordCommand=exports.UserUpdateCommand=exports.UserVerifyCommand=exports.DriverRegisterCommand=exports.UserRegisterCommand=void 0;exports.UserRegisterCommand=class UserRegisterCommand{constructor(name,surname,email,university,studentNumber,password,cellNumber){this.name=name,this.surname=surname,this.email=email,this.university=university,this.studentNumber=studentNumber,this.password=password,this.cellNumber=cellNumber}};exports.DriverRegisterCommand=class DriverRegisterCommand{constructor(ID,licensePlate,carModel,userId){this.ID=ID,this.licensePlate=licensePlate,this.carModel=carModel,this.userId=userId}};exports.UserVerifyCommand=class UserVerifyCommand{constructor(id){this.id=id}};exports.UserUpdateCommand=class UserUpdateCommand{constructor(id,name,surname,email,university,studentNumber,cellNumber){this.id=id,this.name=name,this.surname=surname,this.email=email,this.university=university,this.studentNumber=studentNumber,this.cellNumber=cellNumber}};exports.ResetPasswordCommand=class ResetPasswordCommand{constructor(email,password){this.email=email,this.password=password}};exports.UpdateUserImageCommand=class UpdateUserImageCommand{constructor(id,image){this.id=id,this.image=image}}},3604:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindTopUsersHandler=exports.FindAllUsersHandler=exports.FindTopUniversitiesHandler=exports.FindRecentUsersHandler=exports.FindTotalDriversHandler=exports.FindTotalUsersHandler=exports.ForgotPasswordHandler=exports.FindUserByIdHandler=exports.AdminLoginHandler=exports.UserLoginHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(4255),cqrs_1=__webpack_require__(4628),auth_query_query_1=__webpack_require__(1891);let UserLoginHandler=class UserLoginHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.login(query.email,query.password)}))}};UserLoginHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.UserLoginQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_a:Object])],UserLoginHandler),exports.UserLoginHandler=UserLoginHandler;let AdminLoginHandler=class AdminLoginHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.adminLogin(query.email,query.password)}))}};AdminLoginHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.AdminLoginQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_b:Object])],AdminLoginHandler),exports.AdminLoginHandler=AdminLoginHandler;let FindUserByIdHandler=class FindUserByIdHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findUserById(query.id)}))}};FindUserByIdHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindUserByIdQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_c:Object])],FindUserByIdHandler),exports.FindUserByIdHandler=FindUserByIdHandler;let ForgotPasswordHandler=class ForgotPasswordHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.forgotPassword(query.email)}))}};ForgotPasswordHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.ForgotPasswordQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_d:Object])],ForgotPasswordHandler),exports.ForgotPasswordHandler=ForgotPasswordHandler;let FindTotalUsersHandler=class FindTotalUsersHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findTotalUsers()}))}};FindTotalUsersHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindTotalUsersQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_e:Object])],FindTotalUsersHandler),exports.FindTotalUsersHandler=FindTotalUsersHandler;let FindTotalDriversHandler=class FindTotalDriversHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findTotalDrivers()}))}};FindTotalDriversHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindTotalDriversQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_f:Object])],FindTotalDriversHandler),exports.FindTotalDriversHandler=FindTotalDriversHandler;let FindRecentUsersHandler=class FindRecentUsersHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findRecentUsers()}))}};FindRecentUsersHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindRecentUsersQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_g=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_g:Object])],FindRecentUsersHandler),exports.FindRecentUsersHandler=FindRecentUsersHandler;let FindTopUniversitiesHandler=class FindTopUniversitiesHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findTopUniversities()}))}};FindTopUniversitiesHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindTopUniversitiesQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_h:Object])],FindTopUniversitiesHandler),exports.FindTopUniversitiesHandler=FindTopUniversitiesHandler;let FindAllUsersHandler=class FindAllUsersHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findAllUsers()}))}};FindAllUsersHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindAllUsersQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_j=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_j:Object])],FindAllUsersHandler),exports.FindAllUsersHandler=FindAllUsersHandler;let FindTopUsersHandler=class FindTopUsersHandler{constructor(authRepository){this.authRepository=authRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authRepository.findTopUsers()}))}};FindTopUsersHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(auth_query_query_1.FindTopUsersQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_k=void 0!==repository_1.AuthRepository&&repository_1.AuthRepository)?_k:Object])],FindTopUsersHandler),exports.FindTopUsersHandler=FindTopUsersHandler},1891:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindTopUsersQuery=exports.FindAllUsersQuery=exports.FindTopUniversitiesQuery=exports.FindRecentUsersQuery=exports.FindTotalDriversQuery=exports.FindTotalUsersQuery=exports.ForgotPasswordQuery=exports.FindUserByIdQuery=exports.AdminLoginQuery=exports.UserLoginQuery=void 0;exports.UserLoginQuery=class UserLoginQuery{constructor(email,password){this.email=email,this.password=password}};exports.AdminLoginQuery=class AdminLoginQuery{constructor(email,password){this.email=email,this.password=password}};exports.FindUserByIdQuery=class FindUserByIdQuery{constructor(id){this.id=id}};exports.ForgotPasswordQuery=class ForgotPasswordQuery{constructor(email){this.email=email}};exports.FindTotalUsersQuery=class FindTotalUsersQuery{};exports.FindTotalDriversQuery=class FindTotalDriversQuery{};exports.FindRecentUsersQuery=class FindRecentUsersQuery{};exports.FindTopUniversitiesQuery=class FindTopUniversitiesQuery{};exports.FindAllUsersQuery=class FindAllUsersQuery{};exports.FindTopUsersQuery=class FindTopUsersQuery{}},1481:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(3865),exports)},3865:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BookingsModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),service_1=__webpack_require__(9029),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_2=__webpack_require__(4071),repository_1=__webpack_require__(5621),bookings_resolver_resolver_1=__webpack_require__(9205),service_3=__webpack_require__(4071);let BookingsModule=class BookingsModule{};BookingsModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[service_1.AuthService,service_2.TripsService,repository_1.TripsRepository,bookings_resolver_resolver_1.BookingResolver,prisma_1.PrismaService,service_3.FindAllTripRequestsHandler]})],BookingsModule),exports.BookingsModule=BookingsModule},9205:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;Object.defineProperty(exports,"__esModule",{value:!0}),exports.BookingResolver=exports.PickupLocation=void 0;const tslib_1=__webpack_require__(752),entities_1=__webpack_require__(3265),entities_2=__webpack_require__(8095),service_1=__webpack_require__(4071),graphql_1=__webpack_require__(1161),service_2=__webpack_require__(9029),prisma_1=__webpack_require__(6432),graphql_2=__webpack_require__(1161);let PickupLocation=class PickupLocation{};tslib_1.__decorate([(0,graphql_2.Field)((()=>graphql_2.ID)),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_2.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_2.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_2.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"longitude",void 0),tslib_1.__decorate([(0,graphql_2.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"bookingId",void 0),PickupLocation=tslib_1.__decorate([(0,graphql_2.ObjectType)()],PickupLocation),exports.PickupLocation=PickupLocation;let BookingResolver=class BookingResolver{constructor(tripsService,authService,prisma){this.tripsService=tripsService,this.authService=authService,this.prisma=prisma}user(booking){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(booking.userId)}))}trip(booking){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findTripById(booking.tripId)}))}pickUp(booking){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.findPickupLocation(booking.bookingId)}))}findPickupLocation(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.pickupLocation.findUnique({where:{bookingId}})}))}findAllTripRequests(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findAllTripRequests(userId)}))}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==entities_2.Booking&&entities_2.Booking)?_d:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_e="undefined"!=typeof Promise&&Promise)?_e:Object)],BookingResolver.prototype,"user",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==entities_2.Booking&&entities_2.Booking)?_f:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_g="undefined"!=typeof Promise&&Promise)?_g:Object)],BookingResolver.prototype,"trip",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>PickupLocation)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==entities_2.Booking&&entities_2.Booking)?_h:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_j="undefined"!=typeof Promise&&Promise)?_j:Object)],BookingResolver.prototype,"pickUp",null),tslib_1.__decorate([tslib_1.__param(0,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_k="undefined"!=typeof Promise&&Promise)?_k:Object)],BookingResolver.prototype,"findPickupLocation",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Booking])),tslib_1.__param(0,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_l="undefined"!=typeof Promise&&Promise)?_l:Object)],BookingResolver.prototype,"findAllTripRequests",null),BookingResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_2.Booking)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==service_1.TripsService&&service_1.TripsService)?_a:Object,"function"==typeof(_b=void 0!==service_2.AuthService&&service_2.AuthService)?_b:Object,"function"==typeof(_c=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_c:Object])],BookingResolver),exports.BookingResolver=BookingResolver},1:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(9228),exports)},9228:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriversModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_1=__webpack_require__(9029),service_2=__webpack_require__(5336),repository_1=__webpack_require__(9117),drivers_resolver_resolver_1=__webpack_require__(8257);let DriversModule=class DriversModule{};DriversModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[drivers_resolver_resolver_1.DriversResolver,repository_1.DriversRepository,service_2.DriversService,prisma_1.PrismaService,service_1.AuthService,service_2.FindDriverProfileHandler]})],DriversModule),exports.DriversModule=DriversModule},8257:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriversResolver=void 0;const tslib_1=__webpack_require__(752),entities_1=__webpack_require__(3265),service_1=__webpack_require__(5336),graphql_1=__webpack_require__(1161),service_2=__webpack_require__(9029);let DriversResolver=class DriversResolver{constructor(driversService,authService){this.driversService=driversService,this.authService=authService}user(driver){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(driver.userId)}))}findDriverProfile(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.driversService.findDriverProfile(userId)}))}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==entities_1.Driver&&entities_1.Driver)?_c:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_d="undefined"!=typeof Promise&&Promise)?_d:Object)],DriversResolver.prototype,"user",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.Driver)),tslib_1.__param(0,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_e="undefined"!=typeof Promise&&Promise)?_e:Object)],DriversResolver.prototype,"findDriverProfile",null),DriversResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_1.Driver)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==service_1.DriversService&&service_1.DriversService)?_a:Object,"function"==typeof(_b=void 0!==service_2.AuthService&&service_2.AuthService)?_b:Object])],DriversResolver),exports.DriversResolver=DriversResolver},9117:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(6056),exports),tslib_1.__exportStar(__webpack_require__(5961),exports)},6056:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiDriversRepositoryDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiDriversRepositoryDataAccessModule=class ApiDriversRepositoryDataAccessModule{};ApiDriversRepositoryDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiDriversRepositoryDataAccessModule),exports.ApiDriversRepositoryDataAccessModule=ApiDriversRepositoryDataAccessModule},5961:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriversRepository=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),prisma_1=__webpack_require__(6432);let DriversRepository=class DriversRepository{constructor(prisma){this.prisma=prisma}findDriverProfile(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.driver.findUnique({where:{userId}})}))}};DriversRepository=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_a:Object])],DriversRepository),exports.DriversRepository=DriversRepository},5336:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(6092),exports),tslib_1.__exportStar(__webpack_require__(1764),exports),tslib_1.__exportStar(__webpack_require__(9850),exports)},6092:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiDriversServiceFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiDriversServiceFeatureModule=class ApiDriversServiceFeatureModule{};ApiDriversServiceFeatureModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiDriversServiceFeatureModule),exports.ApiDriversServiceFeatureModule=ApiDriversServiceFeatureModule},1764:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DriversService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),drivers_query_query_1=__webpack_require__(3410);let DriversService=class DriversService{constructor(queryBus){this.queryBus=queryBus}findDriverProfile(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new drivers_query_query_1.FindDriverProfileQuery(userId))}))}};DriversService=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==cqrs_1.QueryBus&&cqrs_1.QueryBus)?_a:Object])],DriversService),exports.DriversService=DriversService},9850:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindDriverProfileHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(9117),cqrs_1=__webpack_require__(4628),drivers_query_query_1=__webpack_require__(3410);let FindDriverProfileHandler=class FindDriverProfileHandler{constructor(driversRepository){this.driversRepository=driversRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.driversRepository.findDriverProfile(query.userId)}))}};FindDriverProfileHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(drivers_query_query_1.FindDriverProfileQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.DriversRepository&&repository_1.DriversRepository)?_a:Object])],FindDriverProfileHandler),exports.FindDriverProfileHandler=FindDriverProfileHandler},3410:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindDriverProfileQuery=void 0;exports.FindDriverProfileQuery=class FindDriverProfileQuery{constructor(userId){this.userId=userId}}},7217:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(7681),exports)},7681:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),data_access_1=__webpack_require__(7842),feature_1=__webpack_require__(6500),message_resolver_resolver_1=__webpack_require__(85),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_1=__webpack_require__(9029);let MessageModule=class MessageModule{};MessageModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[message_resolver_resolver_1.MessageResolver,feature_1.MessageService,feature_1.CreateMessageHandler,feature_1.GetMessagesHandler,prisma_1.PrismaService,service_1.AuthService,data_access_1.MessageRepository,feature_1.GetChatsHandler]})],MessageModule),exports.MessageModule=MessageModule},85:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageResolver=void 0;const tslib_1=__webpack_require__(752),feature_1=__webpack_require__(6500),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(8194),entities_2=__webpack_require__(3265),entities_3=__webpack_require__(8194),service_1=__webpack_require__(9029),pubSub=new(__webpack_require__(1283).PubSub);let MessageResolver=class MessageResolver{constructor(messageService,authService){this.messageService=messageService,this.authService=authService}sender(message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(message.senderId)}))}receiver(message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(message.receiverId)}))}getMessages(senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageService.getMessages(senderId,receiverId)}))}getChats(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageService.getChats(userId)}))}createMessage(message,senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const newMessage=yield this.messageService.createMessage(senderId,receiverId,message);return pubSub.publish("messageSent",{messageSent:newMessage}),newMessage}))}messageSent(){return pubSub.asyncIterator("messageSent")}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_2.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==entities_1.Message&&entities_1.Message)?_c:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_d="undefined"!=typeof Promise&&Promise)?_d:Object)],MessageResolver.prototype,"sender",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_2.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==entities_1.Message&&entities_1.Message)?_e:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_f="undefined"!=typeof Promise&&Promise)?_f:Object)],MessageResolver.prototype,"receiver",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_1.Message])),tslib_1.__param(0,(0,graphql_1.Args)("senderId")),tslib_1.__param(1,(0,graphql_1.Args)("receiverId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_g="undefined"!=typeof Promise&&Promise)?_g:Object)],MessageResolver.prototype,"getMessages",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_3.Chat])),tslib_1.__param(0,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_h="undefined"!=typeof Promise&&Promise)?_h:Object)],MessageResolver.prototype,"getChats",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_1.Message)),tslib_1.__param(0,(0,graphql_1.Args)("message")),tslib_1.__param(1,(0,graphql_1.Args)("senderId")),tslib_1.__param(2,(0,graphql_1.Args)("receiverId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_j="undefined"!=typeof Promise&&Promise)?_j:Object)],MessageResolver.prototype,"createMessage",null),tslib_1.__decorate([(0,graphql_1.Subscription)((()=>entities_1.Message),{name:"messageSent"}),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype",void 0)],MessageResolver.prototype,"messageSent",null),MessageResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_1.Message)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==feature_1.MessageService&&feature_1.MessageService)?_a:Object,"function"==typeof(_b=void 0!==service_1.AuthService&&service_1.AuthService)?_b:Object])],MessageResolver),exports.MessageResolver=MessageResolver},8194:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(9547),exports),tslib_1.__exportStar(__webpack_require__(9179),exports)},9547:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiMessagesApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiMessagesApiSharedEntitiesDataAccessModule=class ApiMessagesApiSharedEntitiesDataAccessModule{};ApiMessagesApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiMessagesApiSharedEntitiesDataAccessModule),exports.ApiMessagesApiSharedEntitiesDataAccessModule=ApiMessagesApiSharedEntitiesDataAccessModule},9179:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageInput=exports.Chat=exports.Message=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(3265);let Message=class Message{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Message.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Message.prototype,"message",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Message.prototype,"senderId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Message.prototype,"receiverId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_a=void 0!==entities_1.User&&entities_1.User)?_a:Object)],Message.prototype,"sender",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_b=void 0!==entities_1.User&&entities_1.User)?_b:Object)],Message.prototype,"receiver",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_c="undefined"!=typeof Date&&Date)?_c:Object)],Message.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_d="undefined"!=typeof Date&&Date)?_d:Object)],Message.prototype,"updatedAt",void 0),Message=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Message),exports.Message=Message;let Chat=class Chat{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Chat.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Chat.prototype,"name",void 0),Chat=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Chat),exports.Chat=Chat;let MessageInput=class MessageInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],MessageInput.prototype,"message",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],MessageInput.prototype,"senderId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],MessageInput.prototype,"receiverId",void 0),MessageInput=tslib_1.__decorate([(0,graphql_1.InputType)()],MessageInput),exports.MessageInput=MessageInput},7842:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(6942),exports),tslib_1.__exportStar(__webpack_require__(2470),exports)},6942:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiMessagesRepositoryDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiMessagesRepositoryDataAccessModule=class ApiMessagesRepositoryDataAccessModule{};ApiMessagesRepositoryDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiMessagesRepositoryDataAccessModule),exports.ApiMessagesRepositoryDataAccessModule=ApiMessagesRepositoryDataAccessModule},2470:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageRepository=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),prisma_1=__webpack_require__(6432),entities_1=__webpack_require__(8194);let MessageRepository=class MessageRepository{constructor(prisma){this.prisma=prisma}createMessage(message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.message.create({data:{senderId:message.senderId,receiverId:message.receiverId,message:message.message}})}))}getMessages(senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.message.findMany({where:{OR:[{senderId,receiverId},{senderId:receiverId,receiverId:senderId}]}})}))}getChats(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const chats=yield this.prisma.message.findMany({where:{OR:[{receiverId:userId},{senderId:userId}]},select:{senderId:!0,receiverId:!0,sender:{select:{name:!0,surname:!0}},receiver:{select:{name:!0,surname:!0}}}});let uniqueChats=[];return chats.map((chat=>{const chatObj=new entities_1.Chat;chat.senderId===userId?(chatObj.userId=chat.receiverId,chatObj.name=`${chat.receiver.name} ${chat.receiver.surname}`):(chatObj.userId=chat.senderId,chatObj.name=`${chat.sender.name} ${chat.sender.surname}`),uniqueChats.push(chatObj)})),uniqueChats=uniqueChats.filter(((value,index,self)=>index===self.findIndex((t=>t.name===value.name&&t.userId===value.userId)))),uniqueChats}))}};MessageRepository=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_a:Object])],MessageRepository),exports.MessageRepository=MessageRepository},6500:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(9439),exports),tslib_1.__exportStar(__webpack_require__(3147),exports),tslib_1.__exportStar(__webpack_require__(5993),exports),tslib_1.__exportStar(__webpack_require__(8106),exports)},9439:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiMessagesServiceFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiMessagesServiceFeatureModule=class ApiMessagesServiceFeatureModule{};ApiMessagesServiceFeatureModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiMessagesServiceFeatureModule),exports.ApiMessagesServiceFeatureModule=ApiMessagesServiceFeatureModule},8106:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateMessageHandler=void 0;const tslib_1=__webpack_require__(752),data_access_1=__webpack_require__(7842),cqrs_1=__webpack_require__(4628),message_command_command_1=__webpack_require__(8805),entities_1=__webpack_require__(8194);let CreateMessageHandler=class CreateMessageHandler{constructor(messageRepository){this.messageRepository=messageRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{senderId,receiverId,message}=command,messageObj=new entities_1.MessageInput;return messageObj.senderId=senderId,messageObj.receiverId=receiverId,messageObj.message=message,yield this.messageRepository.createMessage(messageObj)}))}};CreateMessageHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(message_command_command_1.CreateMessageCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==data_access_1.MessageRepository&&data_access_1.MessageRepository)?_a:Object])],CreateMessageHandler),exports.CreateMessageHandler=CreateMessageHandler},8805:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateMessageCommand=void 0;exports.CreateMessageCommand=class CreateMessageCommand{constructor(senderId,receiverId,message){this.senderId=senderId,this.receiverId=receiverId,this.message=message}}},3147:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),message_query_query_1=__webpack_require__(6106),message_command_command_1=__webpack_require__(8805);let MessageService=class MessageService{constructor(queryBus,commandBus){this.queryBus=queryBus,this.commandBus=commandBus}getMessages(senderId,receiverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new message_query_query_1.GetMessagesQuery(senderId,receiverId))}))}getChats(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new message_query_query_1.GetChatsQuery(userId))}))}createMessage(senderId,receiverId,message){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new message_command_command_1.CreateMessageCommand(senderId,receiverId,message))}))}};MessageService=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==cqrs_1.QueryBus&&cqrs_1.QueryBus)?_a:Object,"function"==typeof(_b=void 0!==cqrs_1.CommandBus&&cqrs_1.CommandBus)?_b:Object])],MessageService),exports.MessageService=MessageService},5993:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.GetChatsHandler=exports.GetMessagesHandler=void 0;const tslib_1=__webpack_require__(752),data_access_1=__webpack_require__(7842),cqrs_1=__webpack_require__(4628),message_query_query_1=__webpack_require__(6106);let GetMessagesHandler=class GetMessagesHandler{constructor(messageRepository){this.messageRepository=messageRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageRepository.getMessages(query.senderId,query.receiverId)}))}};GetMessagesHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(message_query_query_1.GetMessagesQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==data_access_1.MessageRepository&&data_access_1.MessageRepository)?_a:Object])],GetMessagesHandler),exports.GetMessagesHandler=GetMessagesHandler;let GetChatsHandler=class GetChatsHandler{constructor(messageRepository){this.messageRepository=messageRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.messageRepository.getChats(query.userId)}))}};GetChatsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(message_query_query_1.GetChatsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==data_access_1.MessageRepository&&data_access_1.MessageRepository)?_b:Object])],GetChatsHandler),exports.GetChatsHandler=GetChatsHandler},6106:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.GetChatsQuery=exports.GetMessagesQuery=void 0;exports.GetMessagesQuery=class GetMessagesQuery{constructor(senderId,receiverId){this.senderId=senderId,this.receiverId=receiverId}};exports.GetChatsQuery=class GetChatsQuery{constructor(userId){this.userId=userId}}},8271:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(1391),exports)},1391:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.NotificationsModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),service_1=__webpack_require__(9029),notifications_resolver_resolver_1=__webpack_require__(5999);let NotificationsModule=class NotificationsModule{};NotificationsModule=tslib_1.__decorate([(0,common_1.Module)({providers:[service_1.AuthService,notifications_resolver_resolver_1.NotificationResolver],imports:[cqrs_1.CqrsModule]})],NotificationsModule),exports.NotificationsModule=NotificationsModule},5999:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.NotificationResolver=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(8095),service_1=__webpack_require__(9029),entities_2=__webpack_require__(3265);let NotificationResolver=class NotificationResolver{constructor(authService){this.authService=authService}user(notification){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(notification.userId)}))}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_2.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==entities_1.Notification&&entities_1.Notification)?_b:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_c="undefined"!=typeof Promise&&Promise)?_c:Object)],NotificationResolver.prototype,"user",null),NotificationResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_1.Notification)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==service_1.AuthService&&service_1.AuthService)?_a:Object])],NotificationResolver),exports.NotificationResolver=NotificationResolver},6432:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(2099),exports),tslib_1.__exportStar(__webpack_require__(6967),exports)},2099:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiSharedServicesPrismaDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiSharedServicesPrismaDataAccessModule=class ApiSharedServicesPrismaDataAccessModule{};ApiSharedServicesPrismaDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiSharedServicesPrismaDataAccessModule),exports.ApiSharedServicesPrismaDataAccessModule=ApiSharedServicesPrismaDataAccessModule},6967:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrismaService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),client_1=__webpack_require__(3524);let PrismaService=class PrismaService extends client_1.PrismaClient{onModuleInit(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){yield this.$connect()}))}enableShutdownHooks(app){return tslib_1.__awaiter(this,void 0,void 0,(function*(){this.$on("beforeExit",(()=>tslib_1.__awaiter(this,void 0,void 0,(function*(){yield app.close()}))))}))}};PrismaService=tslib_1.__decorate([(0,common_1.Injectable)()],PrismaService),exports.PrismaService=PrismaService},2140:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(2455),exports)},2455:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiShellFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),resolvers_1=__webpack_require__(8321),graphql_1=__webpack_require__(1161),apollo_1=__webpack_require__(9096),resolvers_2=__webpack_require__(3149),resolvers_3=__webpack_require__(1481),feature_1=__webpack_require__(6945),feature_2=__webpack_require__(7217),feature_3=__webpack_require__(1),feature_4=__webpack_require__(8271);let ApiShellFeatureModule=class ApiShellFeatureModule{};ApiShellFeatureModule=tslib_1.__decorate([(0,common_1.Module)({imports:[resolvers_1.AuthenticationModule,feature_1.WeatherModule,feature_3.DriversModule,resolvers_2.TripsModule,resolvers_3.BookingsModule,feature_2.MessageModule,feature_4.NotificationsModule,graphql_1.GraphQLModule.forRoot({autoSchemaFile:!0,playground:!0,introspection:!0,uploads:!1,driver:apollo_1.ApolloDriver,subscriptions:{"graphql-ws":!0,"subscriptions-transport-ws":!0}})]})],ApiShellFeatureModule),exports.ApiShellFeatureModule=ApiShellFeatureModule},3149:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});__webpack_require__(752).__exportStar(__webpack_require__(4829),exports)},4829:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),repository_1=__webpack_require__(5621),trips_resolver_resolver_1=__webpack_require__(2480),service_1=__webpack_require__(4071),cqrs_1=__webpack_require__(4628),prisma_1=__webpack_require__(6432),service_2=__webpack_require__(9029);let TripsModule=class TripsModule{};TripsModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[trips_resolver_resolver_1.TripsResolver,repository_1.TripsRepository,service_1.TripsService,prisma_1.PrismaService,service_1.FindAllHandler,service_1.FindBookingsForMonthHandler,service_1.FindTripsForMonthHandler,service_1.FindBookingsByUserHandler,service_1.FindUpcomingTripsHandler,service_1.FindTripsByMonthHandler,service_1.FindByDriverHandler,service_1.FindByPassengerHandler,service_1.TripsCreateHandler,service_1.SearchTripsHandler,service_1.BookTripHandler,service_1.FindBookingByTripHandler,service_1.TripsDeleteHandler,service_1.TripsUpdateHandler,service_1.FindCoordinatesByTripHandler,service_1.FindTripByIdHandler,service_1.FindBookingByIdHandler,service_2.AuthService,service_1.FindALlNotificationsHandler,service_1.FindByConfirmedTripHandler,service_1.FindByRequestedTripHandler,service_1.BookingUpdatePaymentStatusHandler,service_1.FindBookingByTripAndUserIdHandler,service_1.AcceptTripRequestHandler,service_1.StartTripHandler,service_1.EndTripHandler,service_1.DeclineTripRequestHandler,service_1.FindByPassengerReviewsHandler,service_1.FindByDriverReviewsHandler,service_1.UpdatePassengerReviewsHandler,service_1.UpdateDriverReviewsHandler,service_1.CreateReviewHandler,service_1.FindAllPassengersHandler]})],TripsModule),exports.TripsModule=TripsModule},2480:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsResolver=void 0;const tslib_1=__webpack_require__(752),entities_1=__webpack_require__(3265),entities_2=__webpack_require__(8095),service_1=__webpack_require__(4071),graphql_1=__webpack_require__(1161),service_2=__webpack_require__(9029),pubSub=new(__webpack_require__(1283).PubSub);let TripsResolver=class TripsResolver{constructor(tripsService,authService){this.tripsService=tripsService,this.authService=authService}coordinates(trip){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findCoordinatesByTrip(trip.tripId)}))}passengers(trip){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingByTrip(trip.tripId)}))}driver(trip){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.authService.findUserById(trip.driverId)}))}requestReceived(){return pubSub.asyncIterator("requestReceived")}tripStarted(){return pubSub.asyncIterator("tripStarted")}findAllTrips(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findAll()}))}findAllNotifications(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findAllNotifications(id)}))}findTripsForMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findTripsForMonth()}))}findBookingsByUser(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingsByUser(userId)}))}findTripsByMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findTripsByMonth()}))}findBookingsForMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingsForMonth()}))}findTripById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findTripById(id)}))}findByDriver(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByDriver(id)}))}findByPassenger(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByPassenger(id)}))}findUpcomingTrip(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findUpcomingTrip(id)}))}findBookingByTripAndUserId(tripId,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingByTripAndUserId(tripId,userId)}))}findByConfirmedTrips(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByConfirmedTrips(id)}))}findByRequestedTrips(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByRequestedTrips(id)}))}findByPassengerReviews(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByPassengerReviews(id)}))}findByDriverReviews(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findByDriverReviews(id)}))}findAllPassengers(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findAllPassengers(id)}))}searchTrips(date,startLongitude,startLatitude,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trips=yield this.tripsService.searchTrips(date),searchResults=[];return 0!==trips.length&&trips.map((trip=>{trip.coordinates[0].longitude===startLongitude&&trip.coordinates[0].latitude===startLatitude&&trip.coordinates[1].longitude===destinationLongitude&&trip.coordinates[1].latitude===destinationLatitude&&searchResults.push(trip)})),searchResults}))}create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude)}))}findBookingById(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.findBookingById(bookingId)}))}updatePaymentStatus(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const booking=yield this.tripsService.findBookingById(bookingId),trip=yield this.tripsService.findTripById(booking.tripId),notification=new entities_2.Notification;return notification.message="Payment has been made for one of your trips.",notification.userId=trip.driverId,pubSub.publish("requestReceived",{requestReceived:notification}),yield this.tripsService.updatePaymentStatus(bookingId)}))}updateReviewPassenger(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.updateReviewPassenger(bookingId)}))}updateReviewDriver(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsService.updateReviewDriver(tripId)}))}bookTrip(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trip=yield this.tripsService.findTripById(tripId),notification=new entities_2.Notification;return notification.message="You have a new booking request",notification.userId=trip.driverId,pubSub.publish("requestReceived",{requestReceived:notification}),yield this.tripsService.bookTrip(passengerId,tripId,seatsBooked,status,price,address,longitude,latitude)}))}postReview(byId,forId,tripId,role,comment,rating){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return console.log("POSTREVIEW"),yield this.tripsService.postReview(byId,forId,tripId,role,comment,rating)}))}acceptTripRequest(tripId,bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const booking=yield this.tripsService.findBookingById(bookingId),notification=new entities_2.Notification;return notification.message="Your booking request has been approved",notification.userId=booking.userId,pubSub.publish("requestReceived",{requestReceived:notification}),yield this.tripsService.acceptTripRequest(tripId,bookingId)}))}declineTripRequest(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const booking=yield this.tripsService.findBookingById(bookingId),notification=new entities_2.Notification;return notification.message="Your booking request has been declined",notification.userId=booking.userId,pubSub.publish("requestReceived",{requestReceived:notification}),yield this.tripsService.declineTripRequest(bookingId)}))}startTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const passengers=yield this.tripsService.findBookingByTrip(tripId),notifications=[];return passengers.map((passenger=>{const notification=new entities_2.Notification;notification.message="Your trip has started",notification.userId=passenger.userId,notifications.push(notification)})),pubSub.publish("tripStarted",{tripStarted:notifications}),yield this.tripsService.startTrip(tripId)}))}endTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){console.log("END");const passengers=yield this.tripsService.findBookingByTrip(tripId),notifications=[];return passengers.map((passenger=>{const notification=new entities_2.Notification;notification.message="Your trip has ended",notification.userId=passenger.userId,notifications.push(notification)})),pubSub.publish("tripStarted",{tripStarted:notifications}),yield this.tripsService.endTrip(tripId)}))}};tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>[entities_2.Booking])),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==entities_2.Trip&&entities_2.Trip)?_c:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_d="undefined"!=typeof Promise&&Promise)?_d:Object)],TripsResolver.prototype,"coordinates",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>[entities_2.Location])),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==entities_2.Trip&&entities_2.Trip)?_e:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_f="undefined"!=typeof Promise&&Promise)?_f:Object)],TripsResolver.prototype,"passengers",null),tslib_1.__decorate([(0,graphql_1.ResolveField)((()=>entities_1.User)),tslib_1.__param(0,(0,graphql_1.Root)()),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",["function"==typeof(_g=void 0!==entities_2.Trip&&entities_2.Trip)?_g:Object]),tslib_1.__metadata("design:returntype","function"==typeof(_h="undefined"!=typeof Promise&&Promise)?_h:Object)],TripsResolver.prototype,"driver",null),tslib_1.__decorate([(0,graphql_1.Subscription)((()=>entities_2.Notification),{name:"requestReceived"}),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype",void 0)],TripsResolver.prototype,"requestReceived",null),tslib_1.__decorate([(0,graphql_1.Subscription)((()=>[entities_2.Notification]),{name:"tripStarted"}),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype",void 0)],TripsResolver.prototype,"tripStarted",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_j="undefined"!=typeof Promise&&Promise)?_j:Object)],TripsResolver.prototype,"findAllTrips",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Notification])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_k="undefined"!=typeof Promise&&Promise)?_k:Object)],TripsResolver.prototype,"findAllNotifications",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>Number)),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_l="undefined"!=typeof Promise&&Promise)?_l:Object)],TripsResolver.prototype,"findTripsForMonth",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Booking])),tslib_1.__param(0,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_m="undefined"!=typeof Promise&&Promise)?_m:Object)],TripsResolver.prototype,"findBookingsByUser",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.TripByMonth])),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_o="undefined"!=typeof Promise&&Promise)?_o:Object)],TripsResolver.prototype,"findTripsByMonth",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>Number)),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[]),tslib_1.__metadata("design:returntype","function"==typeof(_p="undefined"!=typeof Promise&&Promise)?_p:Object)],TripsResolver.prototype,"findBookingsForMonth",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_q="undefined"!=typeof Promise&&Promise)?_q:Object)],TripsResolver.prototype,"findTripById",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_r="undefined"!=typeof Promise&&Promise)?_r:Object)],TripsResolver.prototype,"findByDriver",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_s="undefined"!=typeof Promise&&Promise)?_s:Object)],TripsResolver.prototype,"findByPassenger",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_t="undefined"!=typeof Promise&&Promise)?_t:Object)],TripsResolver.prototype,"findUpcomingTrip",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("tripId")),tslib_1.__param(1,(0,graphql_1.Args)("userId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_u="undefined"!=typeof Promise&&Promise)?_u:Object)],TripsResolver.prototype,"findBookingByTripAndUserId",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_v="undefined"!=typeof Promise&&Promise)?_v:Object)],TripsResolver.prototype,"findByConfirmedTrips",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_w="undefined"!=typeof Promise&&Promise)?_w:Object)],TripsResolver.prototype,"findByRequestedTrips",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_x="undefined"!=typeof Promise&&Promise)?_x:Object)],TripsResolver.prototype,"findByPassengerReviews",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_y="undefined"!=typeof Promise&&Promise)?_y:Object)],TripsResolver.prototype,"findByDriverReviews",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_z="undefined"!=typeof Promise&&Promise)?_z:Object)],TripsResolver.prototype,"findAllPassengers",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>[entities_2.Trip])),tslib_1.__param(0,(0,graphql_1.Args)("date")),tslib_1.__param(1,(0,graphql_1.Args)("startLongitude")),tslib_1.__param(2,(0,graphql_1.Args)("startLatitude")),tslib_1.__param(3,(0,graphql_1.Args)("destinationLongitude")),tslib_1.__param(4,(0,graphql_1.Args)("destinationLatitude")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_0="undefined"!=typeof Promise&&Promise)?_0:Object)],TripsResolver.prototype,"searchTrips",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("driver")),tslib_1.__param(1,(0,graphql_1.Args)("tripDate")),tslib_1.__param(2,(0,graphql_1.Args)("seatsAvailable")),tslib_1.__param(3,(0,graphql_1.Args)("price")),tslib_1.__param(4,(0,graphql_1.Args)("status")),tslib_1.__param(5,(0,graphql_1.Args)("startLocationAddress")),tslib_1.__param(6,(0,graphql_1.Args)("startLocationLongitude")),tslib_1.__param(7,(0,graphql_1.Args)("startLocationLatitude")),tslib_1.__param(8,(0,graphql_1.Args)("destinationAddress")),tslib_1.__param(9,(0,graphql_1.Args)("destinationLongitude")),tslib_1.__param(10,(0,graphql_1.Args)("destinationLatitude")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_1="undefined"!=typeof Promise&&Promise)?_1:Object)],TripsResolver.prototype,"create",null),tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_2="undefined"!=typeof Promise&&Promise)?_2:Object)],TripsResolver.prototype,"findBookingById",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_3="undefined"!=typeof Promise&&Promise)?_3:Object)],TripsResolver.prototype,"updatePaymentStatus",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_4="undefined"!=typeof Promise&&Promise)?_4:Object)],TripsResolver.prototype,"updateReviewPassenger",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("tripId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_5="undefined"!=typeof Promise&&Promise)?_5:Object)],TripsResolver.prototype,"updateReviewDriver",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("tripId")),tslib_1.__param(1,(0,graphql_1.Args)("passengerId")),tslib_1.__param(2,(0,graphql_1.Args)("seatsBooked")),tslib_1.__param(3,(0,graphql_1.Args)("status")),tslib_1.__param(4,(0,graphql_1.Args)("price")),tslib_1.__param(5,(0,graphql_1.Args)("address")),tslib_1.__param(6,(0,graphql_1.Args)("longitude")),tslib_1.__param(7,(0,graphql_1.Args)("latitude")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_6="undefined"!=typeof Promise&&Promise)?_6:Object)],TripsResolver.prototype,"bookTrip",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Reviews)),tslib_1.__param(0,(0,graphql_1.Args)("byId")),tslib_1.__param(1,(0,graphql_1.Args)("forId")),tslib_1.__param(2,(0,graphql_1.Args)("tripId")),tslib_1.__param(3,(0,graphql_1.Args)("role")),tslib_1.__param(4,(0,graphql_1.Args)("comment")),tslib_1.__param(5,(0,graphql_1.Args)("rating")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String,String,String,String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_7="undefined"!=typeof Promise&&Promise)?_7:Object)],TripsResolver.prototype,"postReview",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__param(1,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_8="undefined"!=typeof Promise&&Promise)?_8:Object)],TripsResolver.prototype,"acceptTripRequest",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Booking)),tslib_1.__param(0,(0,graphql_1.Args)("bookingId")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_9="undefined"!=typeof Promise&&Promise)?_9:Object)],TripsResolver.prototype,"declineTripRequest",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_10="undefined"!=typeof Promise&&Promise)?_10:Object)],TripsResolver.prototype,"startTrip",null),tslib_1.__decorate([(0,graphql_1.Mutation)((()=>entities_2.Trip)),tslib_1.__param(0,(0,graphql_1.Args)("id")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String]),tslib_1.__metadata("design:returntype","function"==typeof(_11="undefined"!=typeof Promise&&Promise)?_11:Object)],TripsResolver.prototype,"endTrip",null),TripsResolver=tslib_1.__decorate([(0,graphql_1.Resolver)((()=>entities_2.Trip)),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==service_1.TripsService&&service_1.TripsService)?_a:Object,"function"==typeof(_b=void 0!==service_2.AuthService&&service_2.AuthService)?_b:Object])],TripsResolver),exports.TripsResolver=TripsResolver},8095:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(8027),exports),tslib_1.__exportStar(__webpack_require__(1715),exports),tslib_1.__exportStar(__webpack_require__(9477),exports),tslib_1.__exportStar(__webpack_require__(4870),exports),tslib_1.__exportStar(__webpack_require__(5623),exports),tslib_1.__exportStar(__webpack_require__(3978),exports)},8027:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiTripsApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiTripsApiSharedEntitiesDataAccessModule=class ApiTripsApiSharedEntitiesDataAccessModule{};ApiTripsApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiTripsApiSharedEntitiesDataAccessModule),exports.ApiTripsApiSharedEntitiesDataAccessModule=ApiTripsApiSharedEntitiesDataAccessModule},1715:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.BookingStatusUpdate=exports.BookingInput=exports.Booking=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),pickuplocation_entity_entity_1=__webpack_require__(5623),entities_1=__webpack_require__(3265),trip_entity_entity_1=__webpack_require__(9477);let Booking=class Booking{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Booking.prototype,"bookingId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Booking.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Booking.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_a="undefined"!=typeof Date&&Date)?_a:Object)],Booking.prototype,"bookingDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Int)),tslib_1.__metadata("design:type",Number)],Booking.prototype,"seatsBooked",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Booking.prototype,"status",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Float)),tslib_1.__metadata("design:type",Number)],Booking.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>pickuplocation_entity_entity_1.PickupLocation)),tslib_1.__metadata("design:type","function"==typeof(_b=void 0!==pickuplocation_entity_entity_1.PickupLocation&&pickuplocation_entity_entity_1.PickupLocation)?_b:Object)],Booking.prototype,"pickUp",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_c=void 0!==entities_1.User&&entities_1.User)?_c:Object)],Booking.prototype,"user",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>trip_entity_entity_1.Trip)),tslib_1.__metadata("design:type","function"==typeof(_d=void 0!==trip_entity_entity_1.Trip&&trip_entity_entity_1.Trip)?_d:Object)],Booking.prototype,"trip",void 0),Booking=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Booking),exports.Booking=Booking;let BookingInput=class BookingInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"bookingDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"seatsBooked",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"status",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingInput.prototype,"price",void 0),BookingInput=tslib_1.__decorate([(0,graphql_1.InputType)()],BookingInput),exports.BookingInput=BookingInput;let BookingStatusUpdate=class BookingStatusUpdate{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],BookingStatusUpdate.prototype,"bookingId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],BookingStatusUpdate.prototype,"status",void 0),BookingStatusUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],BookingStatusUpdate),exports.BookingStatusUpdate=BookingStatusUpdate},4870:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocationInput=exports.Location=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),trip_entity_entity_1=__webpack_require__(9477);let Location=class Location{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Location.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"longitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Location.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>trip_entity_entity_1.Trip)),tslib_1.__metadata("design:type","function"==typeof(_a=void 0!==trip_entity_entity_1.Trip&&trip_entity_entity_1.Trip)?_a:Object)],Location.prototype,"trip",void 0),Location=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Location),exports.Location=Location;let LocationInput=class LocationInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],LocationInput.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],LocationInput.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],LocationInput.prototype,"longitude",void 0),LocationInput=tslib_1.__decorate([(0,graphql_1.InputType)()],LocationInput),exports.LocationInput=LocationInput},5623:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PickupLocationInput=exports.PickupLocation=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),booking_entity_entity_1=__webpack_require__(1715);let PickupLocation=class PickupLocation{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"longitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocation.prototype,"bookingId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>booking_entity_entity_1.Booking)),tslib_1.__metadata("design:type","function"==typeof(_a=void 0!==booking_entity_entity_1.Booking&&booking_entity_entity_1.Booking)?_a:Object)],PickupLocation.prototype,"booking",void 0),PickupLocation=tslib_1.__decorate([(0,graphql_1.ObjectType)()],PickupLocation),exports.PickupLocation=PickupLocation;let PickupLocationInput=class PickupLocationInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"address",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"latitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"longitude",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],PickupLocationInput.prototype,"bookingId",void 0),PickupLocationInput=tslib_1.__decorate([(0,graphql_1.InputType)()],PickupLocationInput),exports.PickupLocationInput=PickupLocationInput},3978:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReviewInput=exports.Reviews=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161);let Reviews=class Reviews{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Reviews.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Reviews.prototype,"byId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Reviews.prototype,"forId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Reviews.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Reviews.prototype,"role",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Reviews.prototype,"comment",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Reviews.prototype,"rating",void 0),Reviews=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Reviews),exports.Reviews=Reviews;let ReviewInput=class ReviewInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ReviewInput.prototype,"byId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ReviewInput.prototype,"forId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ReviewInput.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ReviewInput.prototype,"role",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ReviewInput.prototype,"comment",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],ReviewInput.prototype,"rating",void 0),ReviewInput=tslib_1.__decorate([(0,graphql_1.InputType)()],ReviewInput),exports.ReviewInput=ReviewInput},9477:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReviewsStatusUpdate=exports.TripStatusUpdate=exports.AcceptTripRequestUpdate=exports.TripsUpdate=exports.TripsInput=exports.TripByMonth=exports.Trip=exports.Notification=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(3265),booking_entity_entity_1=__webpack_require__(1715),location_entity_entity_1=__webpack_require__(4870);let Notification=class Notification{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Notification.prototype,"id",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Notification.prototype,"userId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>String)),tslib_1.__metadata("design:type",String)],Notification.prototype,"message",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>String)),tslib_1.__metadata("design:type",String)],Notification.prototype,"type",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_a="undefined"!=typeof Date&&Date)?_a:Object)],Notification.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_b="undefined"!=typeof Date&&Date)?_b:Object)],Notification.prototype,"updatedAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_c=void 0!==entities_1.User&&entities_1.User)?_c:Object)],Notification.prototype,"user",void 0),Notification=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Notification),exports.Notification=Notification;let Trip=class Trip{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],Trip.prototype,"tripId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Trip.prototype,"driverId",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_d="undefined"!=typeof Date&&Date)?_d:Object)],Trip.prototype,"tripDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Date)),tslib_1.__metadata("design:type","function"==typeof(_e="undefined"!=typeof Date&&Date)?_e:Object)],Trip.prototype,"createdAt",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Int)),tslib_1.__metadata("design:type",Number)],Trip.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Float)),tslib_1.__metadata("design:type",Number)],Trip.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>entities_1.User)),tslib_1.__metadata("design:type","function"==typeof(_f=void 0!==entities_1.User&&entities_1.User)?_f:Object)],Trip.prototype,"driver",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Trip.prototype,"status",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[booking_entity_entity_1.Booking])),tslib_1.__metadata("design:type",Array)],Trip.prototype,"passengers",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[location_entity_entity_1.Location])),tslib_1.__metadata("design:type",Array)],Trip.prototype,"coordinates",void 0),Trip=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Trip),exports.Trip=Trip;let TripByMonth=class TripByMonth{};tslib_1.__decorate([(0,graphql_1.Field)((()=>String)),tslib_1.__metadata("design:type",String)],TripByMonth.prototype,"month",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.Int)),tslib_1.__metadata("design:type",Number)],TripByMonth.prototype,"trips",void 0),TripByMonth=tslib_1.__decorate([(0,graphql_1.ObjectType)()],TripByMonth),exports.TripByMonth=TripByMonth;let TripsInput=class TripsInput{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"driverId",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"tripDate",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsInput.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>[location_entity_entity_1.LocationInput])),tslib_1.__metadata("design:type",Array)],TripsInput.prototype,"coordinates",void 0),TripsInput=tslib_1.__decorate([(0,graphql_1.InputType)()],TripsInput),exports.TripsInput=TripsInput;let TripsUpdate=class TripsUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",Number)],TripsUpdate.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",Number)],TripsUpdate.prototype,"price",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripsUpdate.prototype,"status",void 0),TripsUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],TripsUpdate),exports.TripsUpdate=TripsUpdate;let AcceptTripRequestUpdate=class AcceptTripRequestUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",Number)],AcceptTripRequestUpdate.prototype,"seatsAvailable",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],AcceptTripRequestUpdate.prototype,"status",void 0),AcceptTripRequestUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],AcceptTripRequestUpdate),exports.AcceptTripRequestUpdate=AcceptTripRequestUpdate;let TripStatusUpdate=class TripStatusUpdate{};tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],TripStatusUpdate.prototype,"status",void 0),TripStatusUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],TripStatusUpdate),exports.TripStatusUpdate=TripStatusUpdate;let ReviewsStatusUpdate=class ReviewsStatusUpdate{};tslib_1.__decorate([(0,graphql_1.Field)((()=>graphql_1.ID)),tslib_1.__metadata("design:type",String)],ReviewsStatusUpdate.prototype,"tripId",void 0),ReviewsStatusUpdate=tslib_1.__decorate([(0,graphql_1.InputType)()],ReviewsStatusUpdate),exports.ReviewsStatusUpdate=ReviewsStatusUpdate},5621:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(5870),exports),tslib_1.__exportStar(__webpack_require__(4606),exports)},5870:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiTripsRepositoryDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiTripsRepositoryDataAccessModule=class ApiTripsRepositoryDataAccessModule{};ApiTripsRepositoryDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiTripsRepositoryDataAccessModule),exports.ApiTripsRepositoryDataAccessModule=ApiTripsRepositoryDataAccessModule},4606:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsRepository=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),prisma_1=__webpack_require__(6432),formatDate=date=>{const dateObj=new Date(date),day=dateObj.getDate(),month=dateObj.getMonth(),year=dateObj.getFullYear();return`${day} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][month]} ${year}`};let TripsRepository=class TripsRepository{constructor(prisma){this.prisma=prisma}findAll(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.trip.findMany({orderBy:{tripDate:"desc"}})}))}findAllNotifications(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.notification.findMany({where:{userId:id}})}))}findTripsForMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const now=new Date,firstDay=new Date(now.getFullYear(),now.getMonth(),1),lastDay=new Date(now.getFullYear(),now.getMonth()+1,0);return(yield this.prisma.trip.aggregate({where:{tripDate:{gte:firstDay,lte:lastDay}},_count:!0}))._count}))}findBookingsForMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const now=new Date,firstDay=new Date(now.getFullYear(),now.getMonth(),1),lastDay=new Date(now.getFullYear(),now.getMonth()+1,0);return(yield this.prisma.booking.aggregate({where:{trip:{tripDate:{gte:firstDay,lte:lastDay}}},_count:!0}))._count}))}findBookingsByUser(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.findMany({where:{userId:id}})}))}findTripsByMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.$queryRaw`
    SELECT count(trip_id) AS trips, TO_CHAR(trip_date, 'Mon')
    AS month FROM trip GROUP BY TO_CHAR(trip_date, 'Mon');
    `}))}findTripById(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findUnique({where:{tripId:id}})}))}findUpcomingTrip(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return(yield this.prisma.trip.findMany({where:{OR:[{driverId:id},{passengers:{some:{userId:id}}}],tripDate:{gte:new Date},status:{in:["active","confirmed","paid"]}},orderBy:{tripDate:"desc"}}))[0]}))}findByDriver(driverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.trip.findMany({where:{driverId,tripDate:{lt:new Date},status:"completed"}})}))}findByPassenger(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findMany({where:{passengers:{some:{userId:passengerId}},tripDate:{lt:new Date},status:"completed"}})}))}findByConfirmedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findMany({where:{passengers:{some:{userId:passengerId,status:"unpaid"}},status:"confirmed"}})}))}findByRequestedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.prisma.trip.findMany({where:{passengers:{some:{userId:passengerId,status:"unpaid"}},status:"requested"}})}))}findByPassengerReviews(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return console.log(passengerId),this.prisma.trip.findMany({where:{passengers:{some:{userId:passengerId,reviewed:!1}},status:"completed"}})}))}findAllPassengers(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findMany({where:{tripId:tripID}})}))}findByDriverReviews(DriverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.findMany({where:{driverId:DriverId,reviewed:!1,status:"completed"}})}))}findBookingByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.findMany({where:{tripId:tripID}})}))}findBookingById(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.findUnique({where:{bookingId}})}))}findBookingByTripAndUserId(tripID,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return(yield this.prisma.booking.findMany({where:{tripId:tripID,userId}}))[0]}))}findCoordinatesByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.location.findMany({where:{tripId:tripID}})}))}create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.create({data:{tripDate,seatsAvailable:parseInt(seatsAvailable),price:parseFloat(price),status,coordinates:{create:[{address:startLocationAddress,latitude:startLocationLatitude,longitude:startLocationLongitude},{address:destinationAddress,latitude:destinationLatitude,longitude:destinationLongitude}]},driver:{connect:{id:driver}}}})}))}postReview(byId,forId,tripId,role,comment,rating){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.review.create({data:{byId,forId,tripId,role,comment,rating}})}))}updatePaymentStatus(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const booking=yield this.prisma.booking.update({where:{bookingId:id},data:{status:"paid"}}),trip=yield this.prisma.trip.update({where:{tripId:booking.tripId},data:{seatsAvailable:{decrement:1}}});yield this.prisma.notification.create({data:{userId:trip.driverId,message:`Your trip has been paid for by ${booking.userId}`,type:"payment"}});return booking}))}bookTrip(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trip=yield this.prisma.trip.findUnique({where:{tripId}}),passenger=yield this.prisma.user.findUnique({where:{id:passengerId}});yield this.prisma.notification.create({data:{userId:trip.driverId,message:`You have a new booking request from ${passenger.name} ${passenger.surname}`,type:"bookingRequest"}});return this.prisma.booking.create({data:{trip:{connect:{tripId}},user:{connect:{id:passengerId}},seatsBooked:parseInt(seatsBooked),status,price:parseFloat(price),pickUp:{create:{address,latitude,longitude}}}})}))}update(id,trips){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.update({where:{tripId:id},data:{seatsAvailable:trips.seatsAvailable,price:trips.price}})}))}updateReviewPassenger(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.update({where:{bookingId:id},data:{reviewed:!0}})}))}updateReviewDriver(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.update({where:{tripId:id},data:{reviewed:!0}})}))}delete(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.trip.delete({where:{tripId:id}})}))}searchTrips(date){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const allTrips=yield this.prisma.trip.findMany({select:{tripId:!0,tripDate:!0,seatsAvailable:!0,price:!0,driverId:!0,coordinates:!0,driver:{select:{id:!0,name:!0,profilePic:!0}},createdAt:!0},orderBy:{driver:{avgRating:"desc"}}}),tripsByDate=[];return 0!==allTrips.length?(allTrips.map((trip=>{formatDate(`${trip.tripDate}`)===formatDate(date)&&tripsByDate.push(trip)})),tripsByDate):[]}))}acceptTripRequest(id,bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trip=yield this.prisma.trip.update({where:{tripId:id},data:{seatsAvailable:{decrement:1}}}),booking=yield this.prisma.booking.update({where:{bookingId},data:{status:"unpaid"}});yield this.prisma.notification.create({data:{userId:booking.userId,message:"Your booking request has been accepted",type:"bookingAccepted"}});return trip}))}declineTripRequest(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const booking=yield this.prisma.booking.update({where:{bookingId},data:{status:"declined"}});yield this.prisma.notification.create({data:{userId:booking.userId,message:"Your booking request has been declined",type:"bookingDeclined"}});return booking}))}startTrip(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trip=yield this.prisma.trip.update({where:{tripId:id},data:{status:"active"}});return(yield this.prisma.trip.findUnique({where:{tripId:id},select:{passengers:{select:{userId:!0}}}})).passengers.map((passenger=>tslib_1.__awaiter(this,void 0,void 0,(function*(){yield this.prisma.notification.create({data:{userId:passenger.userId,message:"Your trip has started",type:"tripStarted"}})})))),trip}))}endTrip(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const trip=yield this.prisma.trip.update({where:{tripId:id},data:{status:"completed"}});return(yield this.prisma.trip.findUnique({where:{tripId:id},select:{passengers:!0}})).passengers.map((passenger=>tslib_1.__awaiter(this,void 0,void 0,(function*(){yield this.prisma.notification.create({data:{userId:passenger.userId,message:"Your trip has ended",type:"tripEnded"}})})))),trip}))}findAllTripRequests(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.prisma.booking.findMany({where:{trip:{driverId:userId},status:"requested"}})}))}};TripsRepository=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==prisma_1.PrismaService&&prisma_1.PrismaService)?_a:Object])],TripsRepository),exports.TripsRepository=TripsRepository},4071:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(8215),exports),tslib_1.__exportStar(__webpack_require__(2285),exports),tslib_1.__exportStar(__webpack_require__(1012),exports),tslib_1.__exportStar(__webpack_require__(7042),exports)},8215:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiTripsServiceFeatureModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiTripsServiceFeatureModule=class ApiTripsServiceFeatureModule{};ApiTripsServiceFeatureModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiTripsServiceFeatureModule),exports.ApiTripsServiceFeatureModule=ApiTripsServiceFeatureModule},7042:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m;Object.defineProperty(exports,"__esModule",{value:!0}),exports.EndTripHandler=exports.StartTripHandler=exports.DeclineTripRequestHandler=exports.AcceptTripRequestHandler=exports.TripsDeleteHandler=exports.BookingUpdatePaymentStatusHandler=exports.UpdateDriverReviewsHandler=exports.UpdatePassengerReviewsHandler=exports.TripsUpdateHandler=exports.BookTripHandler=exports.CreateReviewHandler=exports.TripsCreateHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(5621),cqrs_1=__webpack_require__(4628),trips_command_command_1=__webpack_require__(7577),entities_1=__webpack_require__(8095);let TripsCreateHandler=class TripsCreateHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude}=command;return yield this.tripsRepository.create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude)}))}};TripsCreateHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.TripsCreateCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_a:Object])],TripsCreateHandler),exports.TripsCreateHandler=TripsCreateHandler;let CreateReviewHandler=class CreateReviewHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{byId,forId,tripId,role,comment,rating}=command;return yield this.tripsRepository.postReview(byId,forId,tripId,role,comment,rating)}))}};CreateReviewHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.CreateReviewCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_b:Object])],CreateReviewHandler),exports.CreateReviewHandler=CreateReviewHandler;let BookTripHandler=class BookTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId,passengerId,seatsBooked,status,price,address,longitude,latitude}=command;return yield this.tripsRepository.bookTrip(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude)}))}};BookTripHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.BookTripCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_c:Object])],BookTripHandler),exports.BookTripHandler=BookTripHandler;let TripsUpdateHandler=class TripsUpdateHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId,seatsAvailable,price,status}=command,tripUpdate=new entities_1.TripsUpdate;return tripUpdate.seatsAvailable=seatsAvailable,tripUpdate.price=price,tripUpdate.status=status,yield this.tripsRepository.update(tripId,tripUpdate)}))}};TripsUpdateHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.TripsUpdateCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_d:Object])],TripsUpdateHandler),exports.TripsUpdateHandler=TripsUpdateHandler;let UpdatePassengerReviewsHandler=class UpdatePassengerReviewsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{bookingId}=command;return yield this.tripsRepository.updateReviewPassenger(bookingId)}))}};UpdatePassengerReviewsHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.UpdatePassengerReviewsCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_e:Object])],UpdatePassengerReviewsHandler),exports.UpdatePassengerReviewsHandler=UpdatePassengerReviewsHandler;let UpdateDriverReviewsHandler=class UpdateDriverReviewsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId}=command;return yield this.tripsRepository.updateReviewDriver(tripId)}))}};UpdateDriverReviewsHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.UpdateDriverReviewsCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_f:Object])],UpdateDriverReviewsHandler),exports.UpdateDriverReviewsHandler=UpdateDriverReviewsHandler;let BookingUpdatePaymentStatusHandler=class BookingUpdatePaymentStatusHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{bookingId}=command;return yield this.tripsRepository.updatePaymentStatus(bookingId)}))}};BookingUpdatePaymentStatusHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.BookingUpdatePaymentStatusCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_g=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_g:Object])],BookingUpdatePaymentStatusHandler),exports.BookingUpdatePaymentStatusHandler=BookingUpdatePaymentStatusHandler;let TripsDeleteHandler=class TripsDeleteHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId}=command;return yield this.tripsRepository.delete(tripId)}))}};TripsDeleteHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.TripsDeleteCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_h:Object])],TripsDeleteHandler),exports.TripsDeleteHandler=TripsDeleteHandler;let AcceptTripRequestHandler=class AcceptTripRequestHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId,bookingId}=command;return yield this.tripsRepository.acceptTripRequest(tripId,bookingId)}))}};AcceptTripRequestHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.AcceptTripRequestCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_j=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_j:Object])],AcceptTripRequestHandler),exports.AcceptTripRequestHandler=AcceptTripRequestHandler;let DeclineTripRequestHandler=class DeclineTripRequestHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{bookingId}=command;return yield this.tripsRepository.declineTripRequest(bookingId)}))}};DeclineTripRequestHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.DeclineTripRequestCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_k=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_k:Object])],DeclineTripRequestHandler),exports.DeclineTripRequestHandler=DeclineTripRequestHandler;let StartTripHandler=class StartTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId}=command;return yield this.tripsRepository.startTrip(tripId)}))}};StartTripHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.StartTripCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_l=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_l:Object])],StartTripHandler),exports.StartTripHandler=StartTripHandler;let EndTripHandler=class EndTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(command){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const{tripId}=command;return yield this.tripsRepository.endTrip(tripId)}))}};EndTripHandler=tslib_1.__decorate([(0,cqrs_1.CommandHandler)(trips_command_command_1.EndTripCommand),tslib_1.__metadata("design:paramtypes",["function"==typeof(_m=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_m:Object])],EndTripHandler),exports.EndTripHandler=EndTripHandler},7577:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeclineTripRequestCommand=exports.EndTripCommand=exports.StartTripCommand=exports.AcceptTripRequestCommand=exports.TripsDeleteCommand=exports.UpdateDriverReviewsCommand=exports.UpdatePassengerReviewsCommand=exports.BookingUpdatePaymentStatusCommand=exports.TripsUpdateCommand=exports.BookTripCommand=exports.CreateReviewCommand=exports.TripsCreateCommand=void 0;exports.TripsCreateCommand=class TripsCreateCommand{constructor(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){this.driver=driver,this.tripDate=tripDate,this.seatsAvailable=seatsAvailable,this.price=price,this.status=status,this.startLocationAddress=startLocationAddress,this.startLocationLongitude=startLocationLongitude,this.startLocationLatitude=startLocationLatitude,this.destinationAddress=destinationAddress,this.destinationLongitude=destinationLongitude,this.destinationLatitude=destinationLatitude}};exports.CreateReviewCommand=class CreateReviewCommand{constructor(byId,forId,tripId,role,comment,rating){this.byId=byId,this.forId=forId,this.tripId=tripId,this.role=role,this.comment=comment,this.rating=rating}};exports.BookTripCommand=class BookTripCommand{constructor(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude){this.tripId=tripId,this.passengerId=passengerId,this.seatsBooked=seatsBooked,this.status=status,this.price=price,this.address=address,this.longitude=longitude,this.latitude=latitude}};exports.TripsUpdateCommand=class TripsUpdateCommand{constructor(tripId,seatsAvailable,price,status){this.tripId=tripId,this.seatsAvailable=seatsAvailable,this.price=price,this.status=status}};exports.BookingUpdatePaymentStatusCommand=class BookingUpdatePaymentStatusCommand{constructor(bookingId){this.bookingId=bookingId}};exports.UpdatePassengerReviewsCommand=class UpdatePassengerReviewsCommand{constructor(bookingId){this.bookingId=bookingId}};exports.UpdateDriverReviewsCommand=class UpdateDriverReviewsCommand{constructor(tripId){this.tripId=tripId}};exports.TripsDeleteCommand=class TripsDeleteCommand{constructor(tripId){this.tripId=tripId}};exports.AcceptTripRequestCommand=class AcceptTripRequestCommand{constructor(tripId,bookingId){this.tripId=tripId,this.bookingId=bookingId}};exports.StartTripCommand=class StartTripCommand{constructor(tripId){this.tripId=tripId}};exports.EndTripCommand=class EndTripCommand{constructor(tripId){this.tripId=tripId}};exports.DeclineTripRequestCommand=class DeclineTripRequestCommand{constructor(bookingId){this.bookingId=bookingId}}},1012:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w;Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindBookingByIdHandler=exports.FindALlNotificationsHandler=exports.FindBookingsByUserHandler=exports.FindTripsByMonthHandler=exports.FindBookingsForMonthHandler=exports.FindTripsForMonthHandler=exports.FindUpcomingTripsHandler=exports.FindAllTripRequestsHandler=exports.SearchTripsHandler=exports.FindTripByIdHandler=exports.FindCoordinatesByTripHandler=exports.FindBookingByTripAndUserIdHandler=exports.FindBookingByTripHandler=exports.FindByDriverReviewsHandler=exports.FindAllPassengersHandler=exports.FindByPassengerReviewsHandler=exports.FindByRequestedTripHandler=exports.FindByConfirmedTripHandler=exports.FindByPassengerHandler=exports.FindByDriverHandler=exports.FindAllHandler=void 0;const tslib_1=__webpack_require__(752),repository_1=__webpack_require__(5621),cqrs_1=__webpack_require__(4628),trips_query_query_1=__webpack_require__(1684);let FindAllHandler=class FindAllHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findAll()}))}};FindAllHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindAllQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_a:Object])],FindAllHandler),exports.FindAllHandler=FindAllHandler;let FindByDriverHandler=class FindByDriverHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByDriver(query.driverId)}))}};FindByDriverHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindByDriverQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_b=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_b:Object])],FindByDriverHandler),exports.FindByDriverHandler=FindByDriverHandler;let FindByPassengerHandler=class FindByPassengerHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByPassenger(query.passengerId)}))}};FindByPassengerHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindByPassengerQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_c=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_c:Object])],FindByPassengerHandler),exports.FindByPassengerHandler=FindByPassengerHandler;let FindByConfirmedTripHandler=class FindByConfirmedTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByConfirmedTrips(query.passengerId)}))}};FindByConfirmedTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.findByConfirmedTripsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_d=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_d:Object])],FindByConfirmedTripHandler),exports.FindByConfirmedTripHandler=FindByConfirmedTripHandler;let FindByRequestedTripHandler=class FindByRequestedTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByRequestedTrips(query.passengerId)}))}};FindByRequestedTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.findByRequestedTripsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_e=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_e:Object])],FindByRequestedTripHandler),exports.FindByRequestedTripHandler=FindByRequestedTripHandler;let FindByPassengerReviewsHandler=class FindByPassengerReviewsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByPassengerReviews(query.passengerId)}))}};FindByPassengerReviewsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.findByPassengerReviewsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_f=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_f:Object])],FindByPassengerReviewsHandler),exports.FindByPassengerReviewsHandler=FindByPassengerReviewsHandler;let FindAllPassengersHandler=class FindAllPassengersHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findAllPassengers(query.tripID)}))}};FindAllPassengersHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.findAllPassengersQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_g=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_g:Object])],FindAllPassengersHandler),exports.FindAllPassengersHandler=FindAllPassengersHandler;let FindByDriverReviewsHandler=class FindByDriverReviewsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findByDriverReviews(query.DriverId)}))}};FindByDriverReviewsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.findByDriverReviewsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_h=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_h:Object])],FindByDriverReviewsHandler),exports.FindByDriverReviewsHandler=FindByDriverReviewsHandler;let FindBookingByTripHandler=class FindBookingByTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findBookingByTrip(query.tripId)}))}};FindBookingByTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindBookingByTripQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_j=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_j:Object])],FindBookingByTripHandler),exports.FindBookingByTripHandler=FindBookingByTripHandler;let FindBookingByTripAndUserIdHandler=class FindBookingByTripAndUserIdHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findBookingByTripAndUserId(query.tripId,query.userId)}))}};FindBookingByTripAndUserIdHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindBookingByTripAndUserIdQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_k=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_k:Object])],FindBookingByTripAndUserIdHandler),exports.FindBookingByTripAndUserIdHandler=FindBookingByTripAndUserIdHandler;let FindCoordinatesByTripHandler=class FindCoordinatesByTripHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findCoordinatesByTrip(query.tripId)}))}};FindCoordinatesByTripHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindCoordinatesByTripQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_l=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_l:Object])],FindCoordinatesByTripHandler),exports.FindCoordinatesByTripHandler=FindCoordinatesByTripHandler;let FindTripByIdHandler=class FindTripByIdHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findTripById(query.tripId)}))}};FindTripByIdHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindTripByIdQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_m=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_m:Object])],FindTripByIdHandler),exports.FindTripByIdHandler=FindTripByIdHandler;let SearchTripsHandler=class SearchTripsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.searchTrips(query.date)}))}};SearchTripsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.SearchTripsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_o=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_o:Object])],SearchTripsHandler),exports.SearchTripsHandler=SearchTripsHandler;let FindAllTripRequestsHandler=class FindAllTripRequestsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findAllTripRequests(query.userId)}))}};FindAllTripRequestsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindAllTripRequestsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_p=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_p:Object])],FindAllTripRequestsHandler),exports.FindAllTripRequestsHandler=FindAllTripRequestsHandler;let FindUpcomingTripsHandler=class FindUpcomingTripsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findUpcomingTrip(query.userId)}))}};FindUpcomingTripsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindUpcomingTripsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_q=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_q:Object])],FindUpcomingTripsHandler),exports.FindUpcomingTripsHandler=FindUpcomingTripsHandler;let FindTripsForMonthHandler=class FindTripsForMonthHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findTripsForMonth()}))}};FindTripsForMonthHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindTripsForMonthQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_r=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_r:Object])],FindTripsForMonthHandler),exports.FindTripsForMonthHandler=FindTripsForMonthHandler;let FindBookingsForMonthHandler=class FindBookingsForMonthHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findBookingsForMonth()}))}};FindBookingsForMonthHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindBookingsForMonthQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_s=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_s:Object])],FindBookingsForMonthHandler),exports.FindBookingsForMonthHandler=FindBookingsForMonthHandler;let FindTripsByMonthHandler=class FindTripsByMonthHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findTripsByMonth()}))}};FindTripsByMonthHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindTripsByMonthQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_t=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_t:Object])],FindTripsByMonthHandler),exports.FindTripsByMonthHandler=FindTripsByMonthHandler;let FindBookingsByUserHandler=class FindBookingsByUserHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findBookingsByUser(query.userId)}))}};FindBookingsByUserHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindBookingsByUserQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_u=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_u:Object])],FindBookingsByUserHandler),exports.FindBookingsByUserHandler=FindBookingsByUserHandler;let FindALlNotificationsHandler=class FindALlNotificationsHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findAllNotifications(query.userId)}))}};FindALlNotificationsHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindAllNotificationsQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_v=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_v:Object])],FindALlNotificationsHandler),exports.FindALlNotificationsHandler=FindALlNotificationsHandler;let FindBookingByIdHandler=class FindBookingByIdHandler{constructor(tripsRepository){this.tripsRepository=tripsRepository}execute(query){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.tripsRepository.findBookingById(query.bookingId)}))}};FindBookingByIdHandler=tslib_1.__decorate([(0,cqrs_1.QueryHandler)(trips_query_query_1.FindBookingByIdQuery),tslib_1.__metadata("design:paramtypes",["function"==typeof(_w=void 0!==repository_1.TripsRepository&&repository_1.TripsRepository)?_w:Object])],FindBookingByIdHandler),exports.FindBookingByIdHandler=FindBookingByIdHandler},1684:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindBookingByIdQuery=exports.FindAllNotificationsQuery=exports.FindBookingsByUserQuery=exports.FindTripsByMonthQuery=exports.FindBookingsForMonthQuery=exports.FindTripsForMonthQuery=exports.FindUpcomingTripsQuery=exports.FindAllTripRequestsQuery=exports.SearchTripsQuery=exports.FindTripByIdQuery=exports.FindCoordinatesByTripQuery=exports.FindBookingByTripAndUserIdQuery=exports.FindBookingByTripQuery=exports.findByDriverReviewsQuery=exports.findAllPassengersQuery=exports.findByPassengerReviewsQuery=exports.findByRequestedTripsQuery=exports.findByConfirmedTripsQuery=exports.FindByPassengerQuery=exports.FindByDriverQuery=exports.FindAllQuery=void 0;exports.FindAllQuery=class FindAllQuery{};exports.FindByDriverQuery=class FindByDriverQuery{constructor(driverId){this.driverId=driverId}};exports.FindByPassengerQuery=class FindByPassengerQuery{constructor(passengerId){this.passengerId=passengerId}};exports.findByConfirmedTripsQuery=class findByConfirmedTripsQuery{constructor(passengerId){this.passengerId=passengerId}};exports.findByRequestedTripsQuery=class findByRequestedTripsQuery{constructor(passengerId){this.passengerId=passengerId}};exports.findByPassengerReviewsQuery=class findByPassengerReviewsQuery{constructor(passengerId){this.passengerId=passengerId}};exports.findAllPassengersQuery=class findAllPassengersQuery{constructor(tripID){this.tripID=tripID}};exports.findByDriverReviewsQuery=class findByDriverReviewsQuery{constructor(DriverId){this.DriverId=DriverId}};exports.FindBookingByTripQuery=class FindBookingByTripQuery{constructor(tripId){this.tripId=tripId}};exports.FindBookingByTripAndUserIdQuery=class FindBookingByTripAndUserIdQuery{constructor(tripId,userId){this.tripId=tripId,this.userId=userId}};exports.FindCoordinatesByTripQuery=class FindCoordinatesByTripQuery{constructor(tripId){this.tripId=tripId}};exports.FindTripByIdQuery=class FindTripByIdQuery{constructor(tripId){this.tripId=tripId}};exports.SearchTripsQuery=class SearchTripsQuery{constructor(date){this.date=date}};exports.FindAllTripRequestsQuery=class FindAllTripRequestsQuery{constructor(userId){this.userId=userId}};exports.FindUpcomingTripsQuery=class FindUpcomingTripsQuery{constructor(userId){this.userId=userId}};exports.FindTripsForMonthQuery=class FindTripsForMonthQuery{};exports.FindBookingsForMonthQuery=class FindBookingsForMonthQuery{};exports.FindTripsByMonthQuery=class FindTripsByMonthQuery{};exports.FindBookingsByUserQuery=class FindBookingsByUserQuery{constructor(userId){this.userId=userId}};exports.FindAllNotificationsQuery=class FindAllNotificationsQuery{constructor(userId){this.userId=userId}};exports.FindBookingByIdQuery=class FindBookingByIdQuery{constructor(bookingId){this.bookingId=bookingId}}},2285:(__unused_webpack_module,exports,__webpack_require__)=>{var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TripsService=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),trips_query_query_1=__webpack_require__(1684),trips_command_command_1=__webpack_require__(7577);let TripsService=class TripsService{constructor(queryBus,commandBus){this.queryBus=queryBus,this.commandBus=commandBus}findAll(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindAllQuery)}))}findAllNotifications(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return this.queryBus.execute(new trips_query_query_1.FindAllNotificationsQuery(userId))}))}findTripById(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindTripByIdQuery(tripId))}))}findBookingsByUser(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindBookingsByUserQuery(userId))}))}findUpcomingTrip(id){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindUpcomingTripsQuery(id))}))}findByDriver(driverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindByDriverQuery(driverId))}))}findByPassenger(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindByPassengerQuery(passengerId))}))}findTripsForMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindTripsForMonthQuery)}))}findBookingsForMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindBookingsForMonthQuery)}))}findBookingById(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindBookingByIdQuery(bookingId))}))}findByConfirmedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.findByConfirmedTripsQuery(passengerId))}))}findTripsByMonth(){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindTripsByMonthQuery)}))}findByRequestedTrips(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.findByRequestedTripsQuery(passengerId))}))}findByPassengerReviews(passengerId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.findByPassengerReviewsQuery(passengerId))}))}findAllPassengers(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.findAllPassengersQuery(tripID))}))}findByDriverReviews(DriverId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.findByDriverReviewsQuery(DriverId))}))}findBookingByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindBookingByTripQuery(tripID))}))}findBookingByTripAndUserId(tripID,userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindBookingByTripAndUserIdQuery(tripID,userId))}))}findCoordinatesByTrip(tripID){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindCoordinatesByTripQuery(tripID))}))}searchTrips(date){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.SearchTripsQuery(date))}))}create(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.TripsCreateCommand(driver,tripDate,seatsAvailable,price,status,startLocationAddress,startLocationLongitude,startLocationLatitude,destinationAddress,destinationLongitude,destinationLatitude))}))}bookTrip(passengerId,tripId,seatsBooked,status,price,address,latitude,longitude){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.BookTripCommand(tripId,passengerId,seatsBooked,status,price,address,longitude,latitude))}))}postReview(byId,forId,tripId,role,comment,rating){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.CreateReviewCommand(byId,forId,tripId,role,comment,rating))}))}update(tripId,seatsAvailable,price,status){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.TripsUpdateCommand(tripId,seatsAvailable,price,status))}))}updatePaymentStatus(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.BookingUpdatePaymentStatusCommand(bookingId))}))}updateReviewPassenger(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.UpdatePassengerReviewsCommand(bookingId))}))}updateReviewDriver(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.UpdateDriverReviewsCommand(tripId))}))}delete(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.TripsDeleteCommand(tripId))}))}acceptTripRequest(tripId,bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.AcceptTripRequestCommand(tripId,bookingId))}))}declineTripRequest(bookingId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.DeclineTripRequestCommand(bookingId))}))}startTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.StartTripCommand(tripId))}))}endTrip(tripId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.commandBus.execute(new trips_command_command_1.EndTripCommand(tripId))}))}findAllTripRequests(userId){return tslib_1.__awaiter(this,void 0,void 0,(function*(){return yield this.queryBus.execute(new trips_query_query_1.FindAllTripRequestsQuery(userId))}))}};var Role;TripsService=tslib_1.__decorate([(0,common_1.Injectable)(),tslib_1.__metadata("design:paramtypes",["function"==typeof(_a=void 0!==cqrs_1.QueryBus&&cqrs_1.QueryBus)?_a:Object,"function"==typeof(_b=void 0!==cqrs_1.CommandBus&&cqrs_1.CommandBus)?_b:Object])],TripsService),exports.TripsService=TripsService,function(Role){Role.PASSENGER="PASSENGER",Role.DRIVER="DRIVER"}(Role||(Role={}))},6945:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(7435),exports),tslib_1.__exportStar(__webpack_require__(350),exports)},7435:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.WeatherModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),cqrs_1=__webpack_require__(4628),weather_resolver_resolver_1=__webpack_require__(350);let WeatherModule=class WeatherModule{};WeatherModule=tslib_1.__decorate([(0,common_1.Module)({imports:[cqrs_1.CqrsModule],providers:[weather_resolver_resolver_1.WeatherResolver],exports:[]})],WeatherModule),exports.WeatherModule=WeatherModule},350:(__unused_webpack_module,exports,__webpack_require__)=>{var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.WeatherResolver=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161),entities_1=__webpack_require__(4725),axios_1=__webpack_require__(2167);let WeatherResolver=class WeatherResolver{getWeather(lat,long){return tslib_1.__awaiter(this,void 0,void 0,(function*(){const location=yield axios_1.default.get(`http://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey=ZLZ7t3NgGRDKOaXMKZshgK0Gf2UAyv5m&q=${lat}%2C${long}`),conditions=yield axios_1.default.get(`http://dataservice.accuweather.com/currentconditions/v1/${location.data.Key}?apikey=ZLZ7t3NgGRDKOaXMKZshgK0Gf2UAyv5m&details=true`),result={isRaining:!1,isWindy:!1,windSpeed:`${conditions.data[0].Wind.Speed.Metric.Value}km/h`,isSnowing:!1,temperature:`${conditions.data[0].Temperature.Metric.Value}C`};return conditions.data[0].HasPrecipitation&&("Rain"===conditions.data[0].PrecipitationType&&(result.isRaining=!0),"Snow"===conditions.data[0].PrecipitationType&&(result.isSnowing=!0)),conditions.data[0].Wind.Speed.Metric.Value>30&&(result.isWindy=!0),result}))}};tslib_1.__decorate([(0,graphql_1.Query)((()=>entities_1.Weather)),tslib_1.__param(0,(0,graphql_1.Args)("lat")),tslib_1.__param(1,(0,graphql_1.Args)("long")),tslib_1.__metadata("design:type",Function),tslib_1.__metadata("design:paramtypes",[String,String]),tslib_1.__metadata("design:returntype","function"==typeof(_a="undefined"!=typeof Promise&&Promise)?_a:Object)],WeatherResolver.prototype,"getWeather",null),WeatherResolver=tslib_1.__decorate([(0,graphql_1.Resolver)()],WeatherResolver),exports.WeatherResolver=WeatherResolver},4725:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752);tslib_1.__exportStar(__webpack_require__(3651),exports),tslib_1.__exportStar(__webpack_require__(1157),exports)},3651:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ApiWeatherApiSharedEntitiesDataAccessModule=void 0;const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481);let ApiWeatherApiSharedEntitiesDataAccessModule=class ApiWeatherApiSharedEntitiesDataAccessModule{};ApiWeatherApiSharedEntitiesDataAccessModule=tslib_1.__decorate([(0,common_1.Module)({controllers:[],providers:[],exports:[]})],ApiWeatherApiSharedEntitiesDataAccessModule),exports.ApiWeatherApiSharedEntitiesDataAccessModule=ApiWeatherApiSharedEntitiesDataAccessModule},1157:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.Weather=void 0;const tslib_1=__webpack_require__(752),graphql_1=__webpack_require__(1161);let Weather=class Weather{};tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],Weather.prototype,"isRaining",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],Weather.prototype,"isWindy",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Weather.prototype,"windSpeed",void 0),tslib_1.__decorate([(0,graphql_1.Field)((()=>Boolean)),tslib_1.__metadata("design:type",Boolean)],Weather.prototype,"isSnowing",void 0),tslib_1.__decorate([(0,graphql_1.Field)(),tslib_1.__metadata("design:type",String)],Weather.prototype,"temperature",void 0),Weather=tslib_1.__decorate([(0,graphql_1.ObjectType)()],Weather),exports.Weather=Weather},1841:module=>{module.exports=require("@aws-sdk/client-s3")},2138:module=>{module.exports=require("@nestjs-modules/mailer")},2498:module=>{module.exports=require("@nestjs-modules/mailer/dist/adapters/handlebars.adapter")},9096:module=>{module.exports=require("@nestjs/apollo")},6481:module=>{module.exports=require("@nestjs/common")},5793:module=>{module.exports=require("@nestjs/config")},143:module=>{module.exports=require("@nestjs/core")},4628:module=>{module.exports=require("@nestjs/cqrs")},1161:module=>{module.exports=require("@nestjs/graphql")},3524:module=>{module.exports=require("@prisma/client")},7212:module=>{module.exports=require("aws-sdk/clients/s3")},2167:module=>{module.exports=require("axios")},7096:module=>{module.exports=require("bcrypt")},1283:module=>{module.exports=require("graphql-subscriptions")},1738:module=>{module.exports=require("multer")},2776:module=>{module.exports=require("multer-s3")},752:module=>{module.exports=require("tslib")},1017:module=>{module.exports=require("path")},2781:module=>{module.exports=require("stream")}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}var __webpack_exports__={};(()=>{var exports=__webpack_exports__;Object.defineProperty(exports,"__esModule",{value:!0});const tslib_1=__webpack_require__(752),common_1=__webpack_require__(6481),core_1=__webpack_require__(143),app_module_1=__webpack_require__(3292);!function(){tslib_1.__awaiter(this,void 0,void 0,(function*(){const app=yield core_1.NestFactory.create(app_module_1.AppModule);app.setGlobalPrefix("api");const port=process.env.PORT||3333;yield app.listen(port),common_1.Logger.log(` Application is running on: http://localhost:${port}/api`)}))}()})();var __webpack_export_target__=exports;for(var i in __webpack_exports__)__webpack_export_target__[i]=__webpack_exports__[i];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();
//# sourceMappingURL=main.js.map